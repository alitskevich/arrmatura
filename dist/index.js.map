{"version":3,"sources":["webpack://Dzi/webpack/bootstrap","webpack://Dzi/./lib/index.js"],"names":["launch","bootstrap","COUNTER","doc","window","document","REGISTRY","Map","register","ctor","Object","assign","name","NAME","exec","toString","text","TEMPLATE","prototype","getElementById","innerText","compiled","compile","parseXML","$TEMPLATE","resolve","$","set","types","render","elt","length","Application","forEach","staticTypes","concat","getElementsByTagName","filter","e","id","has","type","map","Bootstrap","body","key","payload","subscriberId","cb","$elt","meta","tag","props","subs","requestAnimationFrame","values","setters","k","v","textContent","disabled","class","replace","_","cl","fl","hasEq","eq","indexOf","setAttribute","selected","value","checked","data","$dataset","slice","setListener","ev","keyCode","$attributes","call","$owner","blur","Elmnt","m","parentElt","createTextNode","createElement","owner","lstnrs","$listeners","keys","removeEventListener","p","parentElement","removeChild","delta","isDone","transclude","cursor","applyAttributes","before","nextSibling","firstChild","appendChild","insertBefore","theirs","mines","hasOwnProperty","undefined","prefixP","setter","listeners","T","removeAttribute","fn","addEventListener","get","delete","Component","Ctor","d","defer","defered","push","init","f","$assignDepth","their","mine","toUpperCase","prevElt","constructor","posE","getter","posB","children","c","uid","done","size","ch","entries","componentCtor","parent","app","isInited","cc","Array","isArray","reduce","iff","each","else","partial","a","dataGetter","split","index","itemId","r","s","compileType","dtype","attrs","compileAttrs","aIf","neg","ifElse","find","ifThen","aEach","dataId","res","RE_SINGLE_PLACEHOLDER","RE_PLACEHOLDER","aProps","ref","fctr","compileAttrValue","trim","old","url","ckey","cbusy","cerror","counter","fetch","err","Error","console","error","setTimeout","emit","compilePlaceholder","fnx","pipes","includes","match","idx","pp","RE_XML_ENTITY","RE_XML_COMMENT","RE_ATTRS","RE_ESCAPE_XML_ENTITY","RE_XML_TAG","SUBST_XML_ENTITY","amp","gt","lt","quot","nbsp","ESCAPE_XML_ENTITY","FN_ESCAPE_XML_ENTITY","charCodeAt","FN_XML_ENTITY","substring","String","fromCharCode","decodeXmlEntities","escapeXml","UID","parseAttrs","stringifyAttrs","join","Node","stringify","tab","sattrs","ssubs","stext","_s","ctx","lastIndex","addChild","setText","input","Math","max","min","shift","unshift","getChild"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;QCvCgBA,M,GAAAA,M;QAIAC,S,GAAAA,S;;;;;;;;AAhChB,IAAIC,UAAU,CAAd;AACA,IAAMC,MAAMC,OAAOC,QAAnB;;AAEA;AACA;AACA;;AAEA;AACA,IAAMC,WAAW,IAAIC,GAAJ,EAAjB;AACA,IAAMC,WAAW,SAAXA,QAAW,OAAQ;AACvB;AACAC,SAAO,OAAOA,IAAP,KAAgB,UAAhB,GAA6BA,IAA7B,GAAoCC,OAAOC,MAAP,CAAc,YAAY,CAAE,CAA5B,EAA8BF,IAA9B,CAA3C;AACA;AACA,MAAMG,OAAOH,KAAKI,IAAL,GAAYJ,KAAKI,IAAL,IACvBJ,KAAKG,IADkB,IAEvB,CAAC,4BAA4BE,IAA5B,CAAiCL,KAAKM,QAAL,EAAjC,KAAqD,EAAtD,EAA0D,CAA1D,CAFuB,IAE0C,OAAOb,SAF1E;AAGA;AACA,MAAMc,OAAOP,KAAKQ,QAAL,IACVR,KAAKS,SAAL,CAAeD,QAAf,IAA2BR,KAAKS,SAAL,CAAeD,QAAf,EADjB,IAEX,CAACd,IAAIgB,cAAJ,CAAmBP,IAAnB,KAA4B,EAACQ,4BAA0BR,IAA1B,QAAD,EAA7B,EAAoEQ,SAFtE;AAGA;AACA,MAAMC,WAAWC,QAAQC,SAASP,IAAT,EAAeJ,IAAf,CAAR,CAAjB;AACAH,OAAKe,SAAL,GAAiB;AAAA,WAAKC,QAAQ,IAAIlB,GAAJ,EAAR,EAAmBmB,CAAnB,EAAsBL,QAAtB,CAAL;AAAA,GAAjB;AACA;AACAf,WAASqB,GAAT,CAAaf,IAAb,EAAmBH,IAAnB;AACD,CAhBD;;AAkBA;AACO,SAAST,MAAT,GAA2B;AAAA,oCAAP4B,KAAO;AAAPA,SAAO;AAAA;;AAChC3B,8BAAU,IAAV,SAAmB2B,KAAnB,GAA0BC,MAA1B;AACD;AACD;AACO,SAAS5B,SAAT,CAAoB6B,GAApB,EAAmC;AAAA,qCAAPF,KAAO;AAAPA,SAAO;AAAA;;AACxC,MAAIA,MAAMG,MAAN,KAAiB,CAArB,EAAwB;AACtBH,YAAQ,CAAEI,WAAF,CAAR;AACD;AACDJ,QAAMK,OAAN,CAAczB,QAAd;AACA;AACAA,WAAS,EAACK,MAAM,UAAP,EAAmBI,UAAU,kBAA7B,EAAT;AACA;AACA,MAAMiB,cAAe,EAAD,CAAKC,MAAL,8BAAgBhC,IAAIiC,oBAAJ,CAAyB,QAAzB,CAAhB,IACjBC,MADiB,CACV;AAAA,WAAKC,EAAEC,EAAF,IAAQ,CAACjC,SAASkC,GAAT,CAAaF,EAAEC,EAAf,CAAT,IAA+BD,EAAEG,IAAF,KAAW,iBAA/C;AAAA,GADU,CAApB;AAEAP,cAAYQ,GAAZ,CAAgB;AAAA,WAAM,EAAE7B,MAAMyB,EAAEC,EAAV,EAActB,UAAUqB,EAAElB,SAA1B,EAAN;AAAA,GAAhB,EACGa,OADH,CACWzB,QADX;AAEA;AACA,SAAO,IAAImC,SAAJ,CAAcb,OAAO3B,IAAIyC,IAAzB,EAA+BhB,MAAM,CAAN,CAA/B,CAAP;AACD;;IACYI,W,WAAAA,W;;;;;;;;AACX;2BACQ,CACP;AACD;;;;6BACUa,G,EAAKC,O,EAAS,CACvB;;;8BACUD,G,EAAKE,Y,EAAcC,E,EAAI,CACjC;;;gCACYD,Y,EAAc,CAC1B;AACD;;;;wBACKF,G,EAAK;AACR,aAAOA,GAAP;AACD;AACD;;;;wBACKA,G,EAAK;AACR,aAAOA,GAAP;AACD;;;;;;IAEGF,S;AACJ,qBAAab,GAAb,EAAkBrB,IAAlB,EAAwB;AAAA;;AACtB,SAAKwC,IAAL,GAAYnB,GAAZ;AACA,SAAKoB,IAAL,GAAY,IAAI3C,GAAJ,EAAZ;AACA,SAAK2C,IAAL,CAAUvB,GAAV,CAAc,CAAd,EAAiB,EAAEwB,KAAK1C,KAAKI,IAAZ,EAAkBuC,OAAO,EAAzB,EAA6BC,MAAM,EAAnC,EAAjB;AACD;;;;6BACS;AAAA;;AACRjD,aAAOkD,qBAAP,CAA6B;AAAA,eAAMzB,eAAa,MAAKqB,IAAlB,EAAwB,MAAKD,IAA7B,CAAN;AAAA,OAA7B;AACD;;;;;;AAGH;AACA;AACA;;;AACA,IAAMM,SAAS;AACb,UAAQ,IADK;AAEb,WAAS,KAFI;AAGb,UAAQ;AAHK,CAAf;;AAMA,IAAMC,UAAU;AACd,WAAS,cAAClB,CAAD,EAAImB,CAAJ,EAAOC,CAAP;AAAA,WAAcpB,EAAEqB,WAAF,GAAgBD,KAAK,IAAL,GAAY,EAAZ,GAAiBA,CAA/C;AAAA,GADK;AAEdE,YAAU,kBAACtB,CAAD,EAAImB,CAAJ,EAAOC,CAAP;AAAA,WAAcpB,EAAEmB,CAAF,IAAOC,IAAI,IAAJ,GAAW,IAAhC;AAAA,GAFI;AAGdG,SAAO,gBAACvB,CAAD,EAAImB,CAAJ,EAAOC,CAAP,EAAa;AAClBA,QAAI,CAAC,KAAKA,CAAN,EAASI,OAAT,CAAiB,6CAAjB,EAAgE,UAACC,CAAD,EAAIC,EAAJ,EAAQC,EAAR,EAAYC,KAAZ,EAAmBC,EAAnB,EAA0B;AAC5F,UAAMP,WAAWM,QAAQD,OAAOE,EAAf,GAAoB,CAAC,EAAD,EAAK,GAAL,EAAU,OAAV,EAAmB,KAAnB,EAA0BC,OAA1B,CAAkCH,EAAlC,IAAwC,CAAC,CAA9E;AACA,aAAOL,WAAW,EAAX,GAAgBI,EAAvB;AACD,KAHG,CAAJ;AAIA1B,MAAE+B,YAAF,CAAeZ,CAAf,EAAkBC,CAAlB;AACD,GATa;AAUdY,YAAU,kBAAChC,CAAD,EAAImB,CAAJ,EAAOC,CAAP;AAAA,WAAcpB,EAAEmB,CAAF,IAAOC,IAAI,IAAJ,GAAW,IAAhC;AAAA,GAVI;AAWda,SAAO,eAACjC,CAAD,EAAImB,CAAJ,EAAOC,CAAP;AAAA,WAAcpB,EAAEmB,CAAF,IAAOC,CAArB;AAAA,GAXO;AAYdc,WAAS,iBAAClC,CAAD,EAAImB,CAAJ,EAAOC,CAAP;AAAA,WAAcpB,EAAEmB,CAAF,IAAO,CAAC,CAACC,CAAvB;AAAA,GAZK;AAade,QAAM,cAACnC,CAAD,EAAImB,CAAJ,EAAOC,CAAP,EAAa;AAAEpB,MAAEoC,QAAF,GAAahE,OAAOC,MAAP,CAAc,EAAd,EAAkB+C,CAAlB,CAAb;AAAmC,GAb1C;AAcd,WAAS,cAACpB,CAAD,EAAImB,CAAJ,EAAOC,CAAP,EAAa;AAAE,KAACpB,EAAEoC,QAAF,KAAepC,EAAEoC,QAAF,GAAa,EAA5B,CAAD,EAAkCjB,EAAEkB,KAAF,CAAQ,CAAR,CAAlC,IAAgDjB,KAAKH,MAAL,GAAcA,OAAOG,CAAP,CAAd,GAA0BA,CAA1E;AAA6E,GAdvF;AAed,WAAS,eAAUpB,CAAV,EAAaO,GAAb,EAAkBa,CAAlB,EAAqB;AAAA;;AAC5B,SAAKkB,WAAL,CAAiB,OAAjB,EAA0B,CAAClB,CAAD,GAAK,IAAL,GAAY,UAACmB,EAAD,EAAQ;AAC5C,UAAIA,GAAGC,OAAH,KAAe,EAAnB,EAAuB;AACrB,eAAKC,WAAL,CAAiBlC,GAAjB,EAAsBmC,IAAtB,CAA2B,OAAKC,MAAL,CAAYvD,CAAvC,aAA4C6C,OAAOjC,EAAEiC,KAArD,IAA+DjC,EAAEoC,QAAjE,GAA6EG,EAA7E;AACD;AACD,UAAIA,GAAGC,OAAH,KAAe,EAAf,IAAqBD,GAAGC,OAAH,KAAe,EAAxC,EAA4C;AAC1CxC,UAAE4C,IAAF;AACD;AACD,aAAO,KAAP;AACD,KARD;AASD,GAzBa;AA0Bd,YAAU,gBAAU5C,CAAV,EAAaO,GAAb,EAAkBa,CAAlB,EAAqB;AAAA;;AAC7B,SAAKkB,WAAL,CAAiB,QAAjB,EAA2B,CAAClB,CAAD,GAAK,IAAL,GAAY,UAACmB,EAAD,EAAQ;AAC7C,aAAKE,WAAL,CAAiBlC,GAAjB,EAAsBmC,IAAtB,CAA2B,OAAKC,MAAL,CAAYvD,CAAvC,aAA4C6C,OAAOjC,EAAEkC,OAArD,IAAiElC,EAAEoC,QAAnE,GAA+EG,EAA/E;AACA,aAAO,KAAP;AACD,KAHD;AAID;AA/Ba,CAAhB;;IAkCMM,K;AACJ,iBAAaC,CAAb,EAAgBC,SAAhB,EAA2B;AAAA;;AACzB,SAAK3D,CAAL,GAAS0D,EAAEjC,GAAF,KAAU,OAAV,GAAoBhD,IAAImF,cAAJ,CAAmB,EAAnB,CAApB,GAA6CnF,IAAIoF,aAAJ,CAAkBH,EAAEjC,GAApB,CAAtD;AACA,SAAK4B,WAAL,GAAmB,EAAnB;AACA,SAAKE,MAAL,GAAcG,EAAEI,KAAhB;AACD;;;;2BACO,CACP;;;2BACO;AACN,UAAMlD,IAAI,KAAKZ,CAAf;AACA,UAAM+D,SAAS,KAAKC,UAApB;AACA,UAAID,MAAJ,EAAY;AACV/E,eAAOiF,IAAP,CAAYF,MAAZ,EAAoBxD,OAApB,CAA4B;AAAA,iBAAKK,EAAEsD,mBAAF,CAAsBnC,CAAtB,EAAyBgC,OAAOhC,CAAP,CAAzB,CAAL;AAAA,SAA5B;AACA,aAAKiC,UAAL,GAAkB,IAAlB;AACD;AACD,UAAMG,IAAIvD,EAAEwD,aAAZ;AACA,UAAID,CAAJ,EAAO;AACLA,UAAEE,WAAF,CAAczD,CAAd;AACD;AACD,WAAKW,IAAL,GAAY,KAAK8B,WAAL,GAAmB,KAAKE,MAAL,GAAc,KAAKI,SAAL,GAAiB,IAA9D;AACD;;;2BACOW,K,EAAO;AACb,UAAI,KAAKC,MAAT,EAAiB;AACf;AACD;AACD,UAAM3D,IAAI,KAAKZ,CAAf;AACA,UAAMmE,IAAI,KAAKR,SAAf;AACA,UAAI,KAAKa,UAAT,EAAqB;AACnB5D,UAAE6D,MAAF,GAAW,IAAX;AACAtE,gBAAO,IAAP,EAAa,KAAKqE,UAAlB,EAA8B5D,CAA9B;AACAA,UAAE6D,MAAF,GAAW,IAAX;AACD;AACD,WAAKC,eAAL,CAAqBJ,KAArB;AACA,UAAMK,SAASR,EAAEM,MAAF,GAAWN,EAAEM,MAAF,CAASG,WAApB,GAAkCT,EAAEU,UAAnD;AACA,UAAI,CAACF,MAAL,EAAa;AACXR,UAAEW,WAAF,CAAclE,CAAd;AACD,OAFD,MAEO,IAAIA,MAAM+D,MAAV,EAAkB;AACvBR,UAAEY,YAAF,CAAenE,CAAf,EAAkB+D,MAAlB;AACD;AACDR,QAAEM,MAAF,GAAW7D,CAAX;AACD;;;oCACgBoE,M,EAAQ;AAAA;;AACvB,UAAMpE,IAAI,KAAKZ,CAAf;AACA,UAAMiF,QAAQ,KAAK5B,WAAnB;AACA,WAAK,IAAIlC,GAAT,IAAgB8D,KAAhB,EAAuB;AACrB,YAAIA,MAAMC,cAAN,CAAqB/D,GAArB,KAA6B6D,OAAO7D,GAAP,MAAgBgE,SAAjD,EAA4D;AAC1DH,iBAAO7D,GAAP,IAAc,IAAd;AACD;AACF;;AAPsB,iCAQdA,KARc;AASrB,YAAI6D,OAAOE,cAAP,CAAsB/D,KAAtB,KAA8B6D,OAAO7D,KAAP,MAAgB8D,MAAM9D,KAAN,CAAlD,EAA8D;AAC5D,cAAM0B,QAAQmC,OAAO7D,KAAP,CAAd;AACA,cAAMiE,UAAUjE,MAAIuB,OAAJ,CAAY,GAAZ,CAAhB;AACA,cAAM2C,SAASvD,QAAQsD,YAAY,CAAC,CAAb,GAAiBjE,KAAjB,GAAuBA,MAAI8B,KAAJ,CAAU,CAAV,EAAamC,OAAb,IAAwB,GAAvD,CAAf;AACA,cAAIC,MAAJ,EAAY;AACVA,mBAAO/B,IAAP,SAAkB1C,CAAlB,EAAqBO,KAArB,EAA0B0B,KAA1B;AACD,WAFD,MAEO;AACL,gBAAI,OAAOA,KAAP,KAAiB,UAAjB,IAAgC,OAAKyC,SAAL,IAAkB,OAAKA,SAAL,CAAexE,GAAf,CAAmBK,KAAnB,CAAtD,EAAgF;AAC9E,kBAAMoE,UAAN;AACA,qBAAKrC,WAAL,CAAiB/B,KAAjB,EAAsB,CAAC0B,KAAD,GAAS,IAAT,GAAgB,UAACM,EAAD,EAAQ;AAC5CoC,kBAAElC,WAAF,CAAclC,KAAd,EAAmBmC,IAAnB,CAAwBiC,EAAEhC,MAAF,CAASvD,CAAjC,aAAqC6C,OAAOjC,EAAEiC,KAA9C,IAAwDjC,EAAEoC,QAA1D,GAAqEG,EAArE;AACA,uBAAO,KAAP;AACD,eAHD;AAID,aAND,MAMO;AACL,qBAAKR,YAAL,CAAkBxB,KAAlB,EAAuB0B,KAAvB;AACD;AACF;AACF;AA1BoB;;AAQvB,WAAK,IAAI1B,KAAT,IAAgB6D,MAAhB,EAAwB;AAAA,cAAf7D,KAAe;AAmBvB;AACD,WAAKkC,WAAL,GAAmB2B,MAAnB;AACD;;;iCACa7D,G,EAAK0B,K,EAAO;AACxB,UAAIA,SAAS,IAAb,EAAmB;AACjB,aAAK7C,CAAL,CAAO2C,YAAP,CAAoBxB,GAApB,EAAyB0B,KAAzB;AACD,OAFD,MAEO;AACL,aAAK7C,CAAL,CAAOwF,eAAP,CAAuBrE,GAAvB;AACD;AACF;;;gCACYA,G,EAAKsE,E,EAAI;AACpB,UAAIA,EAAJ,EAAQ;AACN,YAAI,CAAC,KAAKH,SAAV,EAAqB;AACnB,eAAKA,SAAL,GAAiB,IAAIzG,GAAJ,EAAjB;AACD;AACD,YAAI,CAAC,KAAKyG,SAAL,CAAexE,GAAf,CAAmBK,GAAnB,CAAL,EAA8B;AAC5B,eAAKnB,CAAL,CAAO0F,gBAAP,CAAwBvE,GAAxB,EAA6BsE,EAA7B,EAAiC,KAAjC;AACA,eAAKH,SAAL,CAAerF,GAAf,CAAmBkB,GAAnB,EAAwBsE,EAAxB;AACD;AACF,OARD,MAQO;AACL,YAAI,KAAKH,SAAL,IAAkB,KAAKA,SAAL,CAAexE,GAAf,CAAmBK,GAAnB,CAAtB,EAA+C;AAC7C,eAAKnB,CAAL,CAAOkE,mBAAP,CAA2B/C,GAA3B,EAAgC,KAAKmE,SAAL,CAAeK,GAAf,CAAmBxE,GAAnB,CAAhC;AACA,eAAKmE,SAAL,CAAeM,MAAf,CAAsBzE,GAAtB;AACD;AACF;AACF;;;;;;AAGH;AACA;AACA;;;IACM0E,S;AACJ,qBAAanC,CAAb,EAAgBoC,IAAhB,EAAsB;AAAA;;AAAA;;AACpB,SAAK9F,CAAL,GAAS,IAAI8F,IAAJ,EAAT;AACA,SAAK9F,CAAL,CAAOf,MAAP,GAAgB,UAAC8G,CAAD;AAAA,aAAO,OAAK9G,MAAL,CAAY8G,CAAZ,CAAP;AAAA,KAAhB;AACA,SAAK/F,CAAL,CAAOgG,KAAP,GAAe,UAACP,EAAD,EAAQ;AACrB,UAAIA,EAAJ,EAAQ;AACN,SAAC,OAAKQ,OAAL,KAAiB,OAAKA,OAAL,GAAe,EAAhC,CAAD,EAAsCC,IAAtC,CAA2CT,EAA3C;AACD;AACF,KAJD;AAKD;;;;2BACO;AACN,UAAI,KAAKzF,CAAL,CAAOmG,IAAX,EAAiB;AACf,aAAKnG,CAAL,CAAOmG,IAAP,CAAY,IAAZ;AACD;AACF;;;2BACO;AAAA;;AACN,UAAI,KAAKF,OAAT,EAAkB;AAChB,aAAKA,OAAL,CAAa1F,OAAb,CAAqB;AAAA,iBAAK6F,EAAE9C,IAAF,gBAAL;AAAA,SAArB;AACA,eAAO,KAAK2C,OAAZ;AACD;AACF;;;2BACO3B,K,EAAO;AACb,UAAI,CAACA,KAAD,IAAU,KAAKC,MAAnB,EAA2B;AACzB;AACD;AACD;AACA,WAAK8B,YAAL,GAAoB,CAAC,KAAKA,YAAL,IAAqB,CAAtB,IAA2B,CAA/C;AACA,UAAI/B,MAAMjC,CAAV,EAAa;AACXiC,6BAAYA,MAAMjC,CAAlB,EAAwBiC,KAAxB,IAA+BjC,GAAG8C,SAAlC;AACD;AACD;AATa;AAAA;AAAA;;AAAA;AAUb,6BAAcnG,OAAOiF,IAAP,CAAYK,KAAZ,CAAd,8HAAkC;AAAA,cAAzBvC,CAAyB;;AAChC,cAAMuE,QAAQhC,MAAMvC,CAAN,CAAd;AACA,cAAMwE,OAAO,KAAKvG,CAAL,CAAO+B,CAAP,CAAb;AACA,cAAIA,EAAE,CAAF,MAAS,GAAb,EAAkB;AAChBuE,kBAAMhD,IAAN,CAAW,IAAX;AACA;AACD;AACD,cAAIgD,UAAUnB,SAAV,KAAwBmB,UAAUC,IAAV,IAAmB,QAAOD,KAAP,yCAAOA,KAAP,OAAiB,QAAjB,IAA6BA,UAAU,IAAlF,CAAJ,EAA8F;AAC5F,gBAAMjB,SAAS,KAAKrF,CAAL,CAAO,QAAQ+B,EAAE,CAAF,EAAKyE,WAAL,EAAR,GAA6BzE,EAAEkB,KAAF,CAAQ,CAAR,CAApC,CAAf;AACA,gBAAIoC,MAAJ,EAAY;AACVA,qBAAO/B,IAAP,CAAY,KAAKtD,CAAjB,EAAoBsG,KAApB;AACD,aAFD,MAEO;AACL,mBAAKtG,CAAL,CAAO+B,CAAP,IAAYuE,KAAZ;AACD;AACF;AACF;AACD;AA1Ba;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA2Bb,QAAE,KAAKD,YAAP;AACA,UAAI,KAAKA,YAAL,KAAsB,CAA1B,EAA6B;AAC3B,aAAK1C,SAAL,CAAec,MAAf,GAAwB,KAAKgC,OAA7B;AACAtG,gBAAO,IAAP,EAAa,KAAKH,CAAL,CAAO0G,WAAP,CAAmB5G,SAAnB,CAA6B,IAA7B,CAAb,EAAiD,KAAK6D,SAAtD;AACD;AACF;;;wBACI5B,C,EAAG;AACN,UAAI/B,IAAI,KAAKA,CAAb;AACA,UAAIA,EAAE2F,GAAN,EAAW;AACT,eAAO3F,EAAE2F,GAAF,CAAM5D,CAAN,CAAP;AACD;AACD,UAAI4E,OAAO5E,EAAEW,OAAF,CAAU,GAAV,CAAX;AACA,UAAIiE,SAAS,CAAC,CAAd,EAAiB;AACf,YAAMC,SAAS5G,EAAE,QAAQ+B,EAAE,CAAF,EAAKyE,WAAL,EAAR,GAA6BzE,EAAEkB,KAAF,CAAQ,CAAR,CAA/B,CAAf;AACA,YAAMjB,IAAI4E,SAASA,OAAOtD,IAAP,CAAYtD,CAAZ,EAAe+B,CAAf,CAAT,GAA6B/B,EAAE+B,CAAF,CAAvC;AACA,eAAOC,CAAP;AACD;AACD,UAAI6E,OAAO,CAAX;AACA,aAAOF,SAAS,CAAC,CAAjB,EAAoB;AAClB3G,YAAIA,EAAE+B,EAAEkB,KAAF,CAAQ4D,IAAR,EAAcF,IAAd,CAAF,CAAJ;AACA,YAAI,CAAC3G,CAAL,EAAQ;AACN;AACD;AACD6G,eAAOF,OAAO,CAAd;AACAA,eAAO5E,EAAEW,OAAF,CAAU,GAAV,EAAemE,IAAf,CAAP;AACD;AACD,aAAO7G,EAAE+B,EAAEkB,KAAF,CAAQ4D,IAAR,CAAF,CAAP;AACD;;;;;;AAGH;AACA;AACA;;;AACA,SAAS1G,OAAT,CAAiBH,CAAjB,EAAoBwB,IAApB,EAA0BmC,SAA1B,EAAqC;AACnC,MAAI3D,EAAEuE,MAAN,EAAc;AACZ;AACD;AACD;AACA,MAAIvE,EAAE8G,QAAN,EAAgB;AAAA;AAAA;AAAA;;AAAA;AACd,4BAAc9G,EAAE8G,QAAF,CAAWjF,MAAX,EAAd,mIAAmC;AAAA,YAA1BkF,CAA0B;;AACjC,YAAI,CAACvF,KAAKV,GAAL,CAASiG,EAAEC,GAAX,CAAL,EAAsB;AACpBC,eAAKF,CAAL;AACD;AACF;AALa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMf;AACD,MAAIvF,KAAK0F,IAAT,EAAe;AACb,QAAMC,KAAKnH,EAAE8G,QAAF,KAAe9G,EAAE8G,QAAF,GAAa,IAAIjI,GAAJ,EAA5B,CAAX;AACA;AAFa;AAAA;AAAA;;AAAA;AAGb,4BAAqB2C,KAAK4F,OAAL,EAArB,mIAAqC;AAAA;AAAA,YAA3BJ,GAA2B;AAAA,YAAtBtD,CAAsB;;AACnC,YAAI,CAACyD,GAAGrG,GAAH,CAAOkG,GAAP,CAAL,EAAkB;AAChB,cAAMK,gBAAgBzI,SAAS+G,GAAT,CAAajC,EAAEjC,GAAf,CAAtB;AACA,cAAMsF,KAAIM,gBAAgB,IAAIxB,SAAJ,CAAcnC,CAAd,EAAiB2D,aAAjB,CAAhB,GAAkD,IAAI5D,KAAJ,CAAUC,CAAV,CAA5D;AACAqD,aAAEC,GAAF,GAAQA,GAAR;AACAD,aAAEpD,SAAF,GAAcA,SAAd;AACAoD,aAAEO,MAAF,GAAWtH,CAAX;AACA+G,aAAEQ,GAAF,GAAQvH,EAAEuH,GAAF,IAASR,GAAE/G,CAAnB;AACAmH,aAAGlH,GAAH,CAAO+G,GAAP,EAAYD,EAAZ;AACD;AACF;AACD;AAda;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAeb,4BAAqBvF,KAAK4F,OAAL,EAArB,mIAAqC;AAAA;AAAA,YAA3BJ,GAA2B;AAAA,YAAtBtD,CAAsB;;AACnC,YAAMqD,MAAII,GAAGxB,GAAH,CAAOqB,GAAP,CAAV;AACAD,YAAEvC,UAAF,GAAed,EAAE/B,IAAjB;AACAoF,YAAEN,OAAF,GAAY9C,UAAUc,MAAtB;AACAsC,YAAE9H,MAAF,CAASyE,EAAEhC,KAAX;AACD;AACD;AArBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAsBb,4BAAcyF,GAAGtF,MAAH,EAAd,mIAA2B;AAAA,YAAlBkF,GAAkB;;AACzB,YAAI,CAACA,IAAES,QAAP,EAAiB;AACfT,cAAES,QAAF,GAAa,IAAb;AACAT,cAAEZ,IAAF;AACD;AACF;AA3BY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4Bd;AACF;AACD;AACA,SAASc,IAAT,CAAeF,CAAf,EAAkB;AAChB,MAAIA,EAAExC,MAAN,EAAc;AACZ;AACD;AACDwC,IAAExC,MAAF,GAAW,IAAX;AACAwC,IAAEE,IAAF;AACA,MAAIF,EAAED,QAAN,EAAgB;AAAA;AAAA;AAAA;;AAAA;AACd,4BAAeC,EAAED,QAAF,CAAWjF,MAAX,EAAf,mIAAoC;AAAA,YAA3B4F,EAA2B;;AAClCR,aAAKQ,EAAL;AACD;AAHa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIdV,MAAED,QAAF,GAAa,IAAb;AACD;AACD,MAAIC,EAAEO,MAAN,EAAc;AACZP,MAAEO,MAAF,CAASR,QAAT,CAAkBlB,MAAlB,CAAyBmB,EAAEC,GAA3B;AACAD,MAAEO,MAAF,GAAW,IAAX;AACD;AACD,MAAIP,EAAEQ,GAAN,EAAW;AACTR,MAAEQ,GAAF,GAAQ,IAAR;AACD;AACF;;AAED;AACA;AACA;;AAEA,SAASxH,OAAT,CAAkBiB,GAAlB,EAAuB+F,CAAvB,EAA0BvF,IAA1B,EAAgC;AAC9B,MAAI,CAACA,IAAL,EAAW;AACT,WAAOR,GAAP;AACD;AACD,MAAI0G,MAAMC,OAAN,CAAcnG,IAAd,CAAJ,EAAyB;AACvB,WAAOA,KAAKoG,MAAL,CAAY,UAAClE,CAAD,EAAI9C,CAAJ;AAAA,aAAUb,QAAQ2D,CAAR,EAAWqD,CAAX,EAAcnG,CAAd,CAAV;AAAA,KAAZ,EAAwCI,GAAxC,CAAP;AACD;AAN6B,MAOtBD,IAPsB,GAOqBS,IAPrB,CAOtBT,IAPsB;AAAA,MAOhBW,KAPgB,GAOqBF,IAPrB,CAOhBE,KAPgB;AAAA,MAOTC,IAPS,GAOqBH,IAPrB,CAOTG,IAPS;AAAA,MAOHqF,GAPG,GAOqBxF,IAPrB,CAOHwF,GAPG;AAAA,MAOEa,GAPF,GAOqBrG,IAPrB,CAOEqG,GAPF;AAAA,MAOOC,IAPP,GAOqBtG,IAPrB,CAOOsG,IAPP;AAAA,MAOa3G,GAPb,GAOqBK,IAPrB,CAOaL,GAPb;;AAQ9B,MAAMM,MAAMV,KAAKgG,CAAL,CAAZ;AACA,MAAIc,OAAO,CAACA,IAAId,CAAJ,CAAZ,EAAoB;AAClB,WAAOhH,QAAQiB,GAAR,EAAa+F,CAAb,EAAgBc,IAAIE,IAApB,CAAP;AACD;;AAED,MAAItG,QAAQ,YAAZ,EAA0B;AACxB,QAAMuG,UAAUtG,MAAMkG,MAAN,CAAa,UAACK,CAAD,EAAI7B,CAAJ;AAAA,aAAUA,EAAEW,CAAF,EAAKkB,CAAL,CAAV;AAAA,KAAb,EAAgC,EAAhC,EAAoC9G,GAApD;AACA4F,MAAEvC,UAAF,CAAajE,OAAb,CAAqB,UAACyB,CAAD,EAAID,CAAJ,EAAU;AAC7B,UAAIiG,UAAUhG,EAAEb,GAAF,KAAU6G,OAApB,GAA8B,CAAChG,EAAEb,GAArC,EAA0C;AACxCH,YAAIf,GAAJ,CAAQ8B,CAAR,EAAWC,CAAX;AACD;AACF,KAJD;AAKA,WAAOhB,GAAP;AACD;AACD,MAAI8G,IAAJ,EAAU;AACR,QAAM/E,OAAO+E,KAAKI,UAAL,CAAgBnB,CAAhB,CAAb;AACA,WAAO,CAAChE,IAAD,IAAS,CAACA,KAAK1C,MAAf,GAAwBW,GAAxB,GAA8B,CAAC+B,KAAK6E,MAAL,GAAc7E,IAAd,GAAqB,CAAC,KAAKA,IAAN,EAAYoF,KAAZ,CAAkB,GAAlB,CAAtB,EAA8CP,MAA9C,CAAqD,UAAClE,CAAD,EAAIqC,CAAJ,EAAOqC,KAAP,EAAiB;AACzGrB,QAAE/G,CAAF,CAAI8H,KAAKO,MAAT,IAAmBtC,CAAnB;AACAgB,QAAE/G,CAAF,CAAI8H,KAAKO,MAAL,GAAc,OAAlB,IAA6BD,KAA7B;AACA,UAAMvH,KAAQmG,GAAR,WAAgBjB,EAAElF,EAAF,IAAQuH,KAAxB,CAAN;AACA,aAAOrI,QAAQ2D,CAAR,EAAWqD,CAAX,EAAc,EAAEhG,UAAF,EAAQW,YAAR,EAAeC,UAAf,EAAqBqF,KAAKnG,EAA1B,EAAd,CAAP;AACD,KALoC,EAKlCG,GALkC,CAArC;AAMD;AACD,MAAMsH,IAAI;AACRxE,WAAOiD,CADC;AAERtF,YAFQ;AAGRC,WAAO,EAHC;AAIRP,YAJQ;AAKRQ,UAAMA,KAAKtB,MAAL,GAAcsB,KAAKiG,MAAL,CAAY,UAAClE,CAAD,EAAI6E,CAAJ;AAAA,aAAUxI,QAAQ2D,CAAR,EAAWqD,CAAX,EAAcwB,CAAd,CAAV;AAAA,KAAZ,EAAwC,IAAI1J,GAAJ,EAAxC,CAAd,GAAmE;AALjE,GAAV;AA/B8B;AAAA;AAAA;;AAAA;AAsC9B,0BAAc6C,KAAd,mIAAqB;AAAA,UAAZyC,CAAY;;AACnBA,QAAE4C,CAAF,EAAKuB,EAAE5G,KAAP;AACD;AAxC6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAyC9B,SAAOV,IAAIf,GAAJ,CAAQwB,MAAMuF,GAAd,EAAmBsB,CAAnB,CAAP;AACD;;AAED;AACA;AACA;;AAEA,SAASE,WAAT,CAAsB/G,GAAtB,EAA2B;AACzB,MAAMgH,QAAQhH,IAAIwB,KAAJ,CAAU,CAAV,EAAa,CAAb,MAAoB,KAApB,GAA4BxB,IAAIwB,KAAJ,CAAU,CAAV,CAA5B,GAA2C,IAAzD;AACA,SAAOwF,QAASA,UAAU,UAAV,IAAwBA,UAAU,YAAlC,GAAiD;AAAA,WAAKA,KAAL;AAAA,GAAjD,GAA8D;AAAA,WAAK1B,EAAEpB,GAAF,CAAM8C,KAAN,CAAL;AAAA,GAAvE,GAA4F;AAAA,WAAKhH,GAAL;AAAA,GAAnG;AACD;;AAED,SAAS7B,OAAT,OAA6C;AAAA,MAAzB6B,GAAyB,QAAzBA,GAAyB;AAAA,MAApBiH,KAAoB,QAApBA,KAAoB;AAAA,MAAb1B,GAAa,QAAbA,GAAa;AAAA,MAARrF,IAAQ,QAARA,IAAQ;;AAC3C,MAAM2G,IAAI,EAAEtB,QAAF,EAAOjG,MAAMyH,YAAY/G,GAAZ,CAAb,EAA+BC,OAAOiH,aAAaD,KAAb,CAAtC,EAA2DvH,KAAKuH,MAAM/C,GAAN,CAAU,QAAV,CAAhE,EAAV;;AAEA,MAAMiD,MAAMF,MAAM/C,GAAN,CAAU,OAAV,CAAZ;AACA,MAAIiD,GAAJ,EAAS;AACP,QAAMC,MAAMD,IAAI,CAAJ,MAAW,GAAX,GAAiBA,IAAI3F,KAAJ,CAAU,CAAV,CAAjB,GAAgC,IAA5C;AACAqF,MAAET,GAAF,GAAQgB,MAAM;AAAA,aAAK,CAAC9B,EAAEpB,GAAF,CAAMkD,GAAN,CAAN;AAAA,KAAN,GAAyB;AAAA,aAAK,CAAC,CAAC9B,EAAEpB,GAAF,CAAMiD,GAAN,CAAP;AAAA,KAAjC;AACA,QAAIjH,KAAKtB,MAAT,EAAiB;AACf,UAAMyI,SAASnH,KAAKoH,IAAL,CAAU;AAAA,eAAKnI,EAAEa,GAAF,KAAU,SAAf;AAAA,OAAV,CAAf;AACA,UAAMuH,SAASrH,KAAKoH,IAAL,CAAU;AAAA,eAAKnI,EAAEa,GAAF,KAAU,SAAf;AAAA,OAAV,CAAf;AACA,UAAIqH,MAAJ,EAAY;AACVR,UAAET,GAAF,CAAME,IAAN,GAAanI,QAAQkJ,MAAR,EAAgBnH,IAA7B;AACAA,eAAOqH,SAASA,OAAOrH,IAAhB,GAAuBA,KAAKhB,MAAL,CAAY;AAAA,iBAAKC,MAAMkI,MAAX;AAAA,SAAZ,CAA9B;AACD,OAHD,MAGO,IAAIE,MAAJ,EAAY;AACjBrH,eAAOqH,OAAOrH,IAAd;AACD;AACF;AACF;;AAED,MAAMsH,QAAQP,MAAM/C,GAAN,CAAU,SAAV,CAAd;AACA,MAAIsD,KAAJ,EAAW;AAAA,uBACoBA,MAAMd,KAAN,CAAY,GAAZ,CADpB;AAAA;AAAA,QACDE,MADC;AAAA,QACSa,MADT;;AAET,QAAMhB,aAAagB,OAAO,CAAP,MAAc,GAAd,GAAoB;AAAA,aAAKnC,EAAEQ,GAAF,CAAM4B,GAAN,CAAUD,OAAOjG,KAAP,CAAa,CAAb,CAAV,CAAL;AAAA,KAApB,GAAsD,UAAC8D,CAAD;AAAA,aAAOA,EAAEpB,GAAF,CAAMuD,MAAN,CAAP;AAAA,KAAzE;AACAZ,MAAER,IAAF,GAAS,EAAEO,cAAF,EAAUH,sBAAV,EAAT;AACD;;AAEDI,IAAE3G,IAAF,GAASA,KAAKX,GAAL,CAASpB,OAAT,CAAT;AACA,SAAO0I,CAAP;AACD;;AAED,IAAMc,wBAAwB,8BAA9B;AACA,IAAMC,iBAAiB,6BAAvB;AACA,SAASV,YAAT,CAAuBD,KAAvB,EAA8B;AAC5B,MAAMJ,IAAI,EAAV;AACA,MAAIgB,SAAS,IAAb;AACAZ,QAAMnI,OAAN,CAAc,UAACyB,CAAD,EAAID,CAAJ,EAAU;AACtB,QAAIA,EAAEkB,KAAF,CAAQ,CAAR,EAAW,CAAX,MAAkB,KAAtB,EAA6B;AAC3B,UAAIlB,MAAM,UAAV,EAAsB;AACpBuH,iBAAStH,CAAT;AACD;AACD;AACD;AACD;AACA,QAAIA,EAAE,CAAF,MAAS,GAAb,EAAkB;AAChB,UAAMb,MAAMa,EAAEiB,KAAF,CAAQ,CAAR,CAAZ;AACA,aAAOqF,EAAEpC,IAAF,CAAO,UAACa,CAAD,EAAI5C,CAAJ,EAAU;AAAEA,UAAEpC,CAAF,IAAOgF,EAAEQ,GAAF,CAAM4B,GAAN,GAAYpC,EAAEQ,GAAF,CAAM4B,GAAN,CAAUhI,GAAV,CAAZ,GAA6BA,GAApC,CAAyC,OAAOgD,CAAP;AAAU,OAAtE,CAAP;AACD;AACD,QAAInC,EAAE,CAAF,MAAS,GAAT,IAAgBA,EAAE,CAAF,MAAS,GAA7B,EAAkC;AAChC,UAAMuH,MAAMxH,IAAI,MAAhB;AACA,UAAMyH,OAAOC,iBAAiBF,GAAjB,EAAsBvH,EAAEiB,KAAF,CAAQ,CAAR,EAAWyG,IAAX,EAAtB,CAAb;AACA,aAAOpB,EAAEpC,IAAF,CAAO,UAACa,CAAD,EAAI5C,CAAJ,EAAU;AACtB;AACAA,UAAE,MAAMpC,CAAR,IAAa,YAAY;AAAA;;AACvB,cAAM4H,MAAM,KAAK3J,CAAL,CAAOuJ,GAAP,CAAZ;AACA,cAAMK,MAAMJ,KAAKzC,CAAL,EAAQ,EAAR,EAAYwC,GAAZ,CAAZ;AACA,cAAIK,QAAQD,GAAZ,EAAiB;AAAA;;AACf,gBAAME,OAAO9H,IAAI,UAAjB;AACA,gBAAM+H,QAAQ/H,IAAI,OAAlB;AACA,gBAAMgI,SAAShI,IAAI,QAAnB;AACA,gBAAMiI,UAAU,CAAC,KAAKhK,CAAL,CAAO6J,IAAP,KAAgB,CAAjB,IAAsB,CAAtC;AACA,gBAAI,CAAC,KAAKtC,GAAL,CAAS0C,KAAd,EAAqB;AAAA;;AACnB,kBAAMC,MAAM,IAAIC,KAAJ,CAAU,gBAAV,CAAZ;AACAC,sBAAQC,KAAR,CAAcH,GAAd;AACA,mBAAKjL,MAAL,yCAAcsK,GAAd,EAAoBpE,SAApB,4BAAgC2E,KAAhC,EAAwC,KAAxC,4BAAgDC,MAAhD,EAAyDG,GAAzD;AACA;AACD;AACD,gBAAM5I,KAAK,SAALA,EAAK,CAAC+I,KAAD,EAAQtH,IAAR,EAAiB;AAC1B,kBAAIiH,YAAY,OAAKhK,CAAL,CAAO6J,IAAP,CAAhB,EAA8B;AAAA;;AAC5B,uBAAK5K,MAAL,qDAAc8C,CAAd,EAAkBgB,IAAlB,kCAAyBwG,GAAzB,EAA+BK,GAA/B,kCAAqCE,KAArC,EAA6C,KAA7C,kCAAqDC,MAArD,EAA8DM,KAA9D;AACD;AACF,aAJD;AAKA,iBAAKpL,MAAL,2CAAcsK,GAAd,EAAoBK,GAApB,6BAA0BE,KAA1B,EAAkC,IAAlC,6BAAyCD,IAAzC,EAAgDG,OAAhD,6BAA0DD,MAA1D,EAAmE,IAAnE;AACAO,uBAAW;AAAA,qBAAM,OAAK/C,GAAL,CAAS0C,KAAT,CAAeL,GAAf,EAAoB,OAAK5J,CAAzB,EAA4BsB,EAA5B,CAAN;AAAA,aAAX,EAAkD,EAAlD;AACD;AACF,SAtBD;AAuBA,eAAO6C,CAAP;AACD,OA1BM,CAAP;AA2BD;AACD,QAAInC,EAAE,CAAF,MAAS,GAAT,IAAgBA,EAAE,CAAF,MAAS,GAA7B,EAAkC;AAChC,UAAMwH,QAAOC,iBAAiB1H,CAAjB,EAAoBC,EAAEiB,KAAF,CAAQ,CAAR,EAAWyG,IAAX,EAApB,CAAb;AACA,aAAOpB,EAAEpC,IAAF,CAAO,UAACa,CAAD,EAAI5C,CAAJ,EAAU;AACtBA,UAAEpC,CAAF,IAAO,UAACgB,IAAD;AAAA,iBAAWgE,EAAEQ,GAAF,CAAMgD,IAAN,GAAaxD,EAAEQ,GAAF,CAAMgD,IAAN,CAAWf,MAAKzC,CAAL,EAAQ,EAAR,EAAYhF,CAAZ,CAAX,EAA2BgB,IAA3B,CAAb,GAAgDqH,QAAQC,KAAR,CAAc,eAAd,CAA3D;AAAA,SAAP;AACA,eAAOlG,CAAP;AACD,OAHM,CAAP;AAID;;AAEDmE,MAAEpC,IAAF,CAAOuD,iBAAiB1H,CAAjB,EAAoBC,CAApB,CAAP;AACD,GApDD;AAqDA,MAAIsH,MAAJ,EAAY;AACV,QAAM7D,KAAKkD,aAAc,IAAI9J,GAAJ,EAAD,CAAYoB,GAAZ,CAAgB,GAAhB,EAAqBqJ,MAArB,CAAb,EAA2C,CAA3C,CAAX;AACAhB,MAAEpC,IAAF,CAAO,UAACa,CAAD,EAAI5C,CAAJ,EAAU;AAAEsB,SAAGsB,CAAH,EAAM5C,CAAN,EAAU,OAAOA,CAAP;AAAU,KAAvC;AACD;AACD,SAAOmE,CAAP;AACD;;AAED,SAASkC,kBAAT,CAA6BzI,CAA7B,EAAgCC,CAAhC,EAAmC;AACjC,MAAMiC,OAAOjC,EAAEmG,KAAF,CAAQ,GAAR,CAAb;AACA,MAAMhH,MAAM8C,KAAK,CAAL,CAAZ;AACA,MAAIA,KAAK5D,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAO,UAAC0G,CAAD,EAAI5C,CAAJ,EAAU;AAAEA,QAAEpC,CAAF,IAAOgF,EAAEpB,GAAF,CAAMxE,GAAN,CAAP,CAAmB,OAAOgD,CAAP;AAAU,KAAhD;AACD,GAFD,MAEO;AACL,QAAMsG,MAAMxG,KAAKhB,KAAL,CAAW,CAAX,EAAcjC,GAAd,CAAkB;AAAA,aAAKe,EAAE2H,IAAF,EAAL;AAAA,KAAlB,CAAZ;AACA,WAAO,UAAC3C,CAAD,EAAI5C,CAAJ,EAAU;AAAEA,QAAEpC,CAAF,IAAO0I,IAAI7C,MAAJ,CAAW,UAACU,CAAD,EAAIvG,CAAJ;AAAA,eAAUgF,EAAEQ,GAAF,CAAMmD,KAAN,IAAe3D,EAAEQ,GAAF,CAAMmD,KAAN,CAAY3I,CAAZ,CAAf,GAAgCgF,EAAEQ,GAAF,CAAMmD,KAAN,CAAY3I,CAAZ,EAAeuG,CAAf,CAAhC,GAAoDA,CAA9D;AAAA,OAAX,EAA4EvB,EAAEpB,GAAF,CAAMxE,GAAN,CAA5E,CAAP,CAAgG,OAAOgD,CAAP;AAAU,KAA7H;AACD;AACF;;AAED,SAASsF,gBAAT,CAA2B1H,CAA3B,EAA8BC,CAA9B,EAAiC;AAC/B,MAAI,CAACA,EAAE2I,QAAF,CAAW,IAAX,CAAL,EAAuB;AACrB,QAAMrC,IAAItG,MAAM,MAAN,GAAe,IAAf,GAAsBA,MAAM,OAAN,GAAgB,KAAhB,GAAwBA,CAAxD;AACA,WAAO,UAAC+E,CAAD,EAAI5C,CAAJ,EAAU;AAAEA,QAAEpC,CAAF,IAAOuG,CAAP,CAAU,OAAOnE,CAAP;AAAU,KAAvC;AACD;AACD,MAAInC,EAAE4I,KAAF,CAAQxB,qBAAR,CAAJ,EAAoC;AAClC,WAAOoB,mBAAmBzI,CAAnB,EAAsBC,EAAEiB,KAAF,CAAQ,CAAR,EAAW,CAAC,CAAZ,CAAtB,CAAP;AACD;AACD,MAAMwH,MAAM,EAAZ;AACAzI,IAAEI,OAAF,CAAUiH,cAAV,EAA0B,UAACd,CAAD,EAAIpH,GAAJ;AAAA,WAAYsJ,IAAIvE,IAAJ,CAASsE,mBAAmB,MAAMC,IAAIpK,MAA7B,EAAqCc,GAArC,CAAT,CAAZ;AAAA,GAA1B;AACA,SAAO,UAAC4F,CAAD,EAAI5C,CAAJ,EAAU;AACf,QAAI0G,MAAM,CAAV;AACA,QAAMC,KAAK,EAAX;AACA3G,MAAEpC,CAAF,IAAOC,EAAEI,OAAF,CAAUiH,cAAV,EAA0B,UAACd,CAAD,EAAIpH,GAAJ,EAAY;AAC3C,UAAMmH,IAAImC,IAAII,GAAJ,EAAS9D,CAAT,EAAY+D,EAAZ,EAAgB,MAAMD,GAAtB,CAAV;AACAA;AACA,aAAOvC,KAAK,IAAL,GAAY,EAAZ,GAAiBA,CAAxB;AACD,KAJM,CAAP;AAKA,WAAOnE,CAAP;AACD,GATD;AAUD;;AAED;AACA;AACA;;AAEO,IAAMtE,8BAAY,YAAY;AACnC,MAAMkL,gBAAgB,oBAAtB;AACA,MAAMC,iBAAiB,0BAAvB;AACA,MAAMC,WAAW,kCAAjB;AACA,MAAMC,uBAAuB,UAA7B;AACA,MAAMC,aAAa,iFAAnB;;AAEA,MAAMC,mBAAmB;AACvBC,SAAK,GADkB;AAEvBC,QAAI,GAFmB;AAGvBC,QAAI,GAHmB;AAIvBC,aAJuB;AAKvBC,UAAM;AALiB,GAAzB;AAOA,MAAMC,oBAAoB;AACxB,QAAI,QADoB;AAExB,QAAI,OAFoB;AAGxB,QAAI,OAHoB;AAIxB,QAAI,MAJoB;AAKxB,QAAI;AALoB,GAA1B;AAOA,MAAMC,uBAAuB,SAAvBA,oBAAuB;AAAA,WAAKD,kBAAkBhI,EAAEkI,UAAF,CAAa,CAAb,CAAlB,CAAL;AAAA,GAA7B;AACA,MAAMC,gBAAgB,SAAhBA,aAAgB,CAAUxJ,CAAV,EAAa;AACjC,QAAMkG,IAAIlG,EAAEyJ,SAAF,CAAY,CAAZ,EAAezJ,EAAEhC,MAAF,GAAW,CAA1B,CAAV;AACA,WAAOkI,EAAE,CAAF,MAAS,GAAT,GAAewD,OAAOC,YAAP,CAAoB,CAACzD,EAAEtF,KAAF,CAAQ,CAAR,CAArB,CAAf,GAAmDmI,iBAAiB7C,CAAjB,KAAuB,GAAjF;AACD,GAHD;AAIA,MAAM0D,oBAAoB,SAApBA,iBAAoB;AAAA,QAAC1D,CAAD,uEAAK,EAAL;AAAA,WAAYA,EAAEnG,OAAF,CAAU2I,aAAV,EAAyBc,aAAzB,CAAZ;AAAA,GAA1B;AACA,MAAMK,YAAY,SAAZA,SAAY,CAAC3D,CAAD;AAAA,WAAO,CAACA,CAAD,GAAK,EAAL,GAAU,CAAC,KAAKA,CAAN,EAASnG,OAAT,CAAiB8I,oBAAjB,EAAuCS,oBAAvC,CAAjB;AAAA,GAAlB;;AAEA,MAAIQ,MAAM,CAAV;;AAEA,MAAMC,aAAa,SAAbA,UAAa,CAAC7D,CAAD,EAAO;AACxB,QAAMD,IAAI,IAAIzJ,GAAJ,EAAV;AACA,QAAI,CAAC0J,CAAL,EAAQ;AACN,aAAOD,CAAP;AACD;AACD,WAAO,CAAP,EAAU;AACR,UAAI1H,IAAIqK,SAAS7L,IAAT,CAAcmJ,CAAd,CAAR;AACA,UAAI,CAAC3H,CAAL,EAAQ;AACN,eAAO0H,CAAP;AACD;AACDA,QAAErI,GAAF,CAAMW,EAAE,CAAF,CAAN,EAAYqL,kBAAkBrL,EAAE,CAAF,CAAlB,CAAZ;AACD;AACF,GAZD;AAaA,MAAMyL,iBAAiB,SAAjBA,cAAiB,CAAC3D,KAAD,EAAW;AAChC,QAAI,CAACA,KAAD,IAAU,CAACA,MAAMxB,IAArB,EAA2B;AACzB,aAAO,EAAP;AACD;AACD,QAAMoB,IAAI,EAAV;AACAI,UAAMnI,OAAN,CAAc,UAACyB,CAAD,EAAID,CAAJ,EAAU;AACtB,UAAIC,KAAKD,MAAM,OAAf,EAAwB;AACtBuG,UAAEpC,IAAF,CAAO,MAAMnE,CAAN,GAAU,IAAV,GAAiBmK,UAAUlK,CAAV,CAAjB,GAAgC,GAAvC;AACD;AACF,KAJD;AAKA,WAAOsG,EAAEgE,IAAF,CAAO,EAAP,CAAP;AACD,GAXD;;AA5CmC,MAyD7BC,IAzD6B;AA0DjC,kBAAa9K,GAAb,EAAkBiH,KAAlB,EAAyB;AAAA;;AACvB,WAAK1B,GAAL,GAAWmF,KAAX;AACA,WAAK1K,GAAL,GAAWA,OAAO,EAAlB;AACA,WAAKiH,KAAL,GAAaA,SAAS,IAAI7J,GAAJ,EAAtB;AACA,WAAK8C,IAAL,GAAY,EAAZ;AACD;;AA/DgC;AAAA;AAAA,+BAgEvByG,KAhEuB,EAgEhB;AACf,eAAO,KAAKzG,IAAL,CAAUyG,KAAV,CAAP;AACD;AAlEgC;AAAA;AAAA,8BAmExB9I,IAnEwB,EAmElB;AACb,aAAKoJ,KAAL,CAAWzI,GAAX,CAAe,OAAf,EAAwBX,IAAxB;AACD;AArEgC;AAAA;AAAA,+BAsEvBmC,GAtEuB,EAsElBiH,KAtEkB,EAsEX;AACpB,YAAM9H,IAAI,IAAI2L,IAAJ,CAAS9K,GAAT,EAAciH,KAAd,CAAV;AACA,aAAK/G,IAAL,CAAUuE,IAAV,CAAetF,CAAf;AACA,eAAOA,CAAP;AACD;AA1EgC;AAAA;AAAA,iCA2ErB;AACV,eAAO4L,UAAU,IAAV,EAAgB,EAAhB,CAAP;AACD;AA7EgC;;AAAA;AAAA;;AAgFnC,WAASA,SAAT,QAA0CC,GAA1C,EAA+C;AAAA,QAAzBhL,GAAyB,SAAzBA,GAAyB;AAAA,QAApBiH,KAAoB,SAApBA,KAAoB;AAAA,QAAb/G,IAAa,SAAbA,IAAa;;AAC7C,QAAM+K,SAASL,eAAe3D,KAAf,CAAf;AACA,QAAMiE,QAAQhL,KAAKX,GAAL,CAAS;AAAA,aAAKwL,UAAUzF,CAAV,SAAkB0F,GAAlB,CAAL;AAAA,KAAT,EAAwCH,IAAxC,CAA6C,IAA7C,CAAd;AACA,QAAMhN,OAAOoJ,MAAM/C,GAAN,CAAU,OAAV,CAAb;AACA,QAAMiH,QAAQtN,cAAYmN,GAAZ,GAAkBP,UAAU5M,IAAV,CAAlB,GAAsC,EAApD;AACA,WAAUmN,GAAH,SAAUhL,GAAV,GAAgBiL,MAAhB,IAA4B,CAACC,KAAD,IAAU,CAACC,KAAX,GAAmB,IAAnB,WAAgCD,KAAhC,GAAwCC,KAAxC,UAAkDH,GAAlD,UAA0DhL,GAA1D,MAA5B,CAAP;AACD;;AAED,SAAO,UAACoL,EAAD,EAAK1L,GAAL,EAAa;AAClB,QAAMoH,IAAI,CAAC,KAAKsE,EAAN,EAAUnD,IAAV,GAAiBtH,OAAjB,CAAyB4I,cAAzB,EAAyC,EAAzC,CAAV;AACA,QAAM8B,MAAM,CAAC,IAAIP,IAAJ,EAAD,CAAZ;AACA,QAAIQ,YAAY,CAAhB;AACA;AACA,WAAO,CAAP,EAAU;AACR,UAAInM,IAAIuK,WAAW/L,IAAX,CAAgBmJ,CAAhB,CAAR;AACA,UAAI,CAAC3H,CAAL,EAAQ;AACN;AACD;AACD;AACA,UAAMtB,OAAOsB,EAAEwH,KAAF,IAAWG,EAAEtF,KAAF,CAAQ8J,SAAR,EAAmBnM,EAAEwH,KAArB,CAAxB;AACA,UAAI9I,QAAQA,KAAKoK,IAAL,EAAZ,EAAyB;AACvBoD,YAAI,CAAJ,EAAOE,QAAP,CAAgB,OAAhB,EAAyBC,OAAzB,CAAiC3N,IAAjC;AACD;AACD;AACA,UAAIsB,EAAE,CAAF,CAAJ,EAAU;AACR,YAAIkM,IAAI,CAAJ,EAAOrL,GAAP,KAAeb,EAAE,CAAF,CAAnB,EAAyB;AACvB,gBAAM,IAAIuJ,KAAJ,CACJ,CAAChJ,OAAO,EAAR,IAAc,4CAAd,GAA6DP,EAAEwH,KAA/D,GACA,QADA,GACWxH,EAAEsM,KAAF,CAAQjK,KAAR,CAAckK,KAAKC,GAAL,CAASxM,EAAEwH,KAAF,GAAU,EAAnB,EAAuB,CAAvB,CAAd,EAAyC+E,KAAKE,GAAL,CAASzM,EAAEwH,KAAF,GAAU,EAAnB,EAAuBxH,EAAEsM,KAAF,CAAQ7M,MAA/B,CAAzC,CAFP,CAAN;AAGD;AACDyM,YAAIQ,KAAJ;AACD,OAPD,MAOO;AACL,YAAMlN,MAAM0M,IAAI,CAAJ,EAAOE,QAAP,CAAgBpM,EAAE,CAAF,CAAhB,EAAsBwL,WAAWxL,EAAE,CAAF,CAAX,CAAtB,CAAZ;AACA;AACA,YAAI,CAACA,EAAE,CAAF,CAAL,EAAW;AACTkM,cAAIS,OAAJ,CAAYnN,GAAZ;AACA,cAAI0M,IAAIzM,MAAJ,KAAe,CAAnB,EAAsB;AACpB,kBAAM,IAAI8J,KAAJ,CAAU,qBAAqBvJ,EAAE,CAAF,CAA/B,CAAN;AACD;AACF;AACF;AACD;AACAmM,kBAAY5B,WAAW4B,SAAvB;AACD;AACD;AACA,WAAOD,IAAI,CAAJ,EAAOU,QAAP,CAAgB,CAAhB,CAAP;AACD,GAtCD;AAuCD,CA/HuB,EAAjB,C","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","let COUNTER = 1\nconst doc = window.document\n\n// ==========\n// Bootstrap\n// ----------\n\n// type registry\nconst REGISTRY = new Map()\nconst register = ctor => {\n  // narrow non-function ctor\n  ctor = typeof ctor === 'function' ? ctor : Object.assign(function () {}, ctor)\n  // narrow name\n  const name = ctor.NAME = ctor.NAME ||\n    ctor.name ||\n    (/^function\\s+([\\w$]+)\\s*\\(/.exec(ctor.toString()) || [])[1] || ('$C' + COUNTER++)\n  // narrow template\n  const text = ctor.TEMPLATE ||\n    (ctor.prototype.TEMPLATE && ctor.prototype.TEMPLATE()) ||\n    (doc.getElementById(name) || {innerText: `<noop name=\"${name}\"/>`}).innerText\n  // compile\n  const compiled = compile(parseXML(text, name))\n  ctor.$TEMPLATE = $ => resolve(new Map(), $, compiled)\n  // register\n  REGISTRY.set(name, ctor)\n}\n\n// bootstap a components tree and render immediately on <body/>\nexport function launch (...types) {\n  bootstrap(null, ...types).render()\n}\n// bootstap a components tree\nexport function bootstrap (elt, ...types) {\n  if (types.length === 0) {\n    types = [ Application ]\n  }\n  types.forEach(register)\n  // register transparent container: <ui:fragment>\n  register({NAME: 'fragment', TEMPLATE: '<ui:transclude/>'})\n  // collect and register `bare-template` definitions\n  const staticTypes = ([]).concat([...doc.getElementsByTagName('script')])\n    .filter(e => e.id && !REGISTRY.has(e.id) && e.type === 'text/x-template')\n  staticTypes.map(e => ({ NAME: e.id, TEMPLATE: e.innerText }))\n    .forEach(register)\n  // use `<body>` as mount element by default\n  return new Bootstrap(elt || doc.body, types[0])\n}\nexport class Application {\n  // hook on init\n  init () {\n  }\n  // event-driven:\n  dispatch (key, payload) {\n  }\n  subscribe (key, subscriberId, cb) {\n  }\n  unsubscribe (subscriberId) {\n  }\n  // resolves properties\n  get (key) {\n    return key\n  }\n  // resolves static resources\n  res (key) {\n    return key\n  }\n}\nclass Bootstrap {\n  constructor (elt, ctor) {\n    this.$elt = elt\n    this.meta = new Map()\n    this.meta.set(0, { tag: ctor.NAME, props: {}, subs: [] })\n  }\n  render () {\n    window.requestAnimationFrame(() => render(this, this.meta, this.$elt))\n  }\n}\n\n// ==========\n// Virtual DOM Element\n// ----------\nconst values = {\n  'true': true,\n  'false': false,\n  'null': null\n}\n\nconst setters = {\n  '#text': (e, k, v) => (e.textContent = v == null ? '' : v),\n  disabled: (e, k, v) => (e[k] = v ? true : null),\n  class: (e, k, v) => {\n    v = ('' + v).replace(/([a-z0-9]+):([a-z0-9.]*)(=([a-z0-9.]*))?\\b/g, (_, cl, fl, hasEq, eq) => {\n      const disabled = hasEq ? fl !== eq : ['', '0', 'false', 'off'].indexOf(fl) > -1\n      return disabled ? '' : cl\n    })\n    e.setAttribute(k, v)\n  },\n  selected: (e, k, v) => (e[k] = v ? true : null),\n  value: (e, k, v) => (e[k] = v),\n  checked: (e, k, v) => (e[k] = !!v),\n  data: (e, k, v) => { e.$dataset = Object.assign({}, v) },\n  'data*': (e, k, v) => { (e.$dataset || (e.$dataset = {}))[k.slice(5)] = v in values ? values[v] : v },\n  'enter': function (e, key, v) {\n    this.setListener('keyup', !v ? null : (ev) => {\n      if (ev.keyCode === 13) {\n        this.$attributes[key].call(this.$owner.$, { value: e.value, ...e.$dataset }, ev)\n      }\n      if (ev.keyCode === 13 || ev.keyCode === 27) {\n        e.blur()\n      }\n      return false\n    })\n  },\n  'toggle': function (e, key, v) {\n    this.setListener('change', !v ? null : (ev) => {\n      this.$attributes[key].call(this.$owner.$, { value: e.checked, ...e.$dataset }, ev)\n      return false\n    })\n  }\n}\n\nclass Elmnt {\n  constructor (m, parentElt) {\n    this.$ = m.tag === '#text' ? doc.createTextNode('') : doc.createElement(m.tag)\n    this.$attributes = {}\n    this.$owner = m.owner\n  }\n  init () {\n  }\n  done () {\n    const e = this.$\n    const lstnrs = this.$listeners\n    if (lstnrs) {\n      Object.keys(lstnrs).forEach(k => e.removeEventListener(k, lstnrs[k]))\n      this.$listeners = null\n    }\n    const p = e.parentElement\n    if (p) {\n      p.removeChild(e)\n    }\n    this.$elt = this.$attributes = this.$owner = this.parentElt = null\n  }\n  assign (delta) {\n    if (this.isDone) {\n      return\n    }\n    const e = this.$\n    const p = this.parentElt\n    if (this.transclude) {\n      e.cursor = null\n      render(this, this.transclude, e)\n      e.cursor = null\n    }\n    this.applyAttributes(delta)\n    const before = p.cursor ? p.cursor.nextSibling : p.firstChild\n    if (!before) {\n      p.appendChild(e)\n    } else if (e !== before) {\n      p.insertBefore(e, before)\n    }\n    p.cursor = e\n  }\n  applyAttributes (theirs) {\n    const e = this.$\n    const mines = this.$attributes\n    for (let key in mines) {\n      if (mines.hasOwnProperty(key) && theirs[key] === undefined) {\n        theirs[key] = null\n      }\n    }\n    for (let key in theirs) {\n      if (theirs.hasOwnProperty(key) && theirs[key] !== mines[key]) {\n        const value = theirs[key]\n        const prefixP = key.indexOf('-')\n        const setter = setters[prefixP === -1 ? key : key.slice(0, prefixP) + '*']\n        if (setter) {\n          setter.call(this, e, key, value)\n        } else {\n          if (typeof value === 'function' || (this.listeners && this.listeners.has(key))) {\n            const T = this\n            this.setListener(key, !value ? null : (ev) => {\n              T.$attributes[key].call(T.$owner.$, {value: e.value, ...e.$dataset}, ev)\n              return false\n            })\n          } else {\n            this.setAttribute(key, value)\n          }\n        }\n      }\n    }\n    this.$attributes = theirs\n  }\n  setAttribute (key, value) {\n    if (value != null) {\n      this.$.setAttribute(key, value)\n    } else {\n      this.$.removeAttribute(key)\n    }\n  }\n  setListener (key, fn) {\n    if (fn) {\n      if (!this.listeners) {\n        this.listeners = new Map()\n      }\n      if (!this.listeners.has(key)) {\n        this.$.addEventListener(key, fn, false)\n        this.listeners.set(key, fn)\n      }\n    } else {\n      if (this.listeners && this.listeners.has(key)) {\n        this.$.removeEventListener(key, this.listeners.get(key))\n        this.listeners.delete(key)\n      }\n    }\n  }\n}\n\n// ==========\n// Component\n// ----------\nclass Component {\n  constructor (m, Ctor) {\n    this.$ = new Ctor()\n    this.$.assign = (d) => this.assign(d)\n    this.$.defer = (fn) => {\n      if (fn) {\n        (this.defered || (this.defered = [])).push(fn)\n      }\n    }\n  }\n  init () {\n    if (this.$.init) {\n      this.$.init(this)\n    }\n  }\n  done () {\n    if (this.defered) {\n      this.defered.forEach(f => f.call(this, this))\n      delete this.defered\n    }\n  }\n  assign (delta) {\n    if (!delta || this.isDone) {\n      return\n    }\n    // prevent recursive invalidations\n    this.$assignDepth = (this.$assignDepth || 0) + 1\n    if (delta._) {\n      delta = {...delta._, ...delta, _: undefined}\n    }\n    // iterate payload\n    for (let k of Object.keys(delta)) {\n      const their = delta[k]\n      const mine = this.$[k]\n      if (k[0] === '$') {\n        their.call(this)\n        continue\n      }\n      if (their !== undefined && (their !== mine || (typeof their === 'object' && their !== null))) {\n        const setter = this.$['set' + k[0].toUpperCase() + k.slice(1)]\n        if (setter) {\n          setter.call(this.$, their)\n        } else {\n          this.$[k] = their\n        }\n      }\n    }\n    // prevent recursive invalidations\n    --this.$assignDepth\n    if (this.$assignDepth === 0) {\n      this.parentElt.cursor = this.prevElt\n      render(this, this.$.constructor.$TEMPLATE(this), this.parentElt)\n    }\n  }\n  get (k) {\n    let $ = this.$\n    if ($.get) {\n      return $.get(k)\n    }\n    let posE = k.indexOf('.')\n    if (posE === -1) {\n      const getter = $['get' + k[0].toUpperCase() + k.slice(1)]\n      const v = getter ? getter.call($, k) : $[k]\n      return v\n    }\n    let posB = 0\n    while (posE !== -1) {\n      $ = $[k.slice(posB, posE)]\n      if (!$) {\n        return\n      }\n      posB = posE + 1\n      posE = k.indexOf('.', posB)\n    }\n    return $[k.slice(posB)]\n  }\n}\n\n// ==========\n// Rendering. MetaTree -> ViewTree(Components,Elements)\n// ----------\nfunction render ($, meta, parentElt) {\n  if ($.isDone) {\n    return\n  }\n  // done\n  if ($.children) {\n    for (let c of $.children.values()) {\n      if (!meta.has(c.uid)) {\n        done(c)\n      }\n    }\n  }\n  if (meta.size) {\n    const ch = $.children || ($.children = new Map())\n    // create\n    for (let [uid, m] of meta.entries()) {\n      if (!ch.has(uid)) {\n        const componentCtor = REGISTRY.get(m.tag)\n        const c = componentCtor ? new Component(m, componentCtor) : new Elmnt(m)\n        c.uid = uid\n        c.parentElt = parentElt\n        c.parent = $\n        c.app = $.app || c.$\n        ch.set(uid, c)\n      }\n    }\n    // assign\n    for (let [uid, m] of meta.entries()) {\n      const c = ch.get(uid)\n      c.transclude = m.subs\n      c.prevElt = parentElt.cursor\n      c.assign(m.props)\n    }\n    // init\n    for (let c of ch.values()) {\n      if (!c.isInited) {\n        c.isInited = true\n        c.init()\n      }\n    }\n  }\n}\n// done\nfunction done (c) {\n  if (c.isDone) {\n    return\n  }\n  c.isDone = true\n  c.done()\n  if (c.children) {\n    for (let cc of c.children.values()) {\n      done(cc)\n    }\n    c.children = null\n  }\n  if (c.parent) {\n    c.parent.children.delete(c.uid)\n    c.parent = null\n  }\n  if (c.app) {\n    c.app = null\n  }\n}\n\n// ==========\n// Template Resolution. GeneratorTree + Data -> MetaTree\n// ----------\n\nfunction resolve (map, c, meta) {\n  if (!meta) {\n    return map\n  }\n  if (Array.isArray(meta)) {\n    return meta.reduce((m, e) => resolve(m, c, e), map)\n  }\n  const { type, props, subs, uid, iff, each, key } = meta\n  const tag = type(c)\n  if (iff && !iff(c)) {\n    return resolve(map, c, iff.else)\n  }\n\n  if (tag === 'transclude') {\n    const partial = props.reduce((a, f) => f(c, a), {}).key\n    c.transclude.forEach((v, k) => {\n      if (partial ? v.key === partial : !v.key) {\n        map.set(k, v)\n      }\n    })\n    return map\n  }\n  if (each) {\n    const data = each.dataGetter(c)\n    return !data || !data.length ? map : (data.reduce ? data : ('' + data).split(',')).reduce((m, d, index) => {\n      c.$[each.itemId] = d\n      c.$[each.itemId + 'Index'] = index\n      const id = `${uid}-$${d.id || index}`\n      return resolve(m, c, { type, props, subs, uid: id })\n    }, map)\n  }\n  const r = {\n    owner: c,\n    tag,\n    props: {},\n    key,\n    subs: subs.length ? subs.reduce((m, s) => resolve(m, c, s), new Map()) : null\n  }\n  for (let p of props) {\n    p(c, r.props)\n  }\n  return map.set(tag + uid, r)\n}\n\n// ==========\n// Template Compilation. NodeTree -> GeneratorTree\n// ----------\n\nfunction compileType (tag) {\n  const dtype = tag.slice(0, 3) === 'ui:' ? tag.slice(3) : null\n  return dtype ? (dtype === 'fragment' || dtype === 'transclude' ? c => dtype : c => c.get(dtype)) : c => tag\n}\n\nfunction compile ({ tag, attrs, uid, subs }) {\n  const r = { uid, type: compileType(tag), props: compileAttrs(attrs), key: attrs.get('ui:key') }\n\n  const aIf = attrs.get('ui:if')\n  if (aIf) {\n    const neg = aIf[0] === '!' ? aIf.slice(1) : null\n    r.iff = neg ? c => !c.get(neg) : c => !!c.get(aIf)\n    if (subs.length) {\n      const ifElse = subs.find(e => e.tag === 'ui:else')\n      const ifThen = subs.find(e => e.tag === 'ui:then')\n      if (ifElse) {\n        r.iff.else = compile(ifElse).subs\n        subs = ifThen ? ifThen.subs : subs.filter(e => e !== ifElse)\n      } else if (ifThen) {\n        subs = ifThen.subs\n      }\n    }\n  }\n\n  const aEach = attrs.get('ui:each')\n  if (aEach) {\n    const [ itemId, , dataId ] = aEach.split(' ')\n    const dataGetter = dataId[0] === ':' ? c => c.app.res(dataId.slice(1)) : (c) => c.get(dataId)\n    r.each = { itemId, dataGetter }\n  }\n\n  r.subs = subs.map(compile)\n  return r\n}\n\nconst RE_SINGLE_PLACEHOLDER = /^\\{\\{([a-zA-Z0-9._$|]+)\\}\\}$/\nconst RE_PLACEHOLDER = /\\{\\{([a-zA-Z0-9._$|]+)\\}\\}/g\nfunction compileAttrs (attrs) {\n  const r = []\n  let aProps = null\n  attrs.forEach((v, k) => {\n    if (k.slice(0, 3) === 'ui:') {\n      if (k === 'ui:props') {\n        aProps = v\n      }\n      return\n    }\n    // localize by key\n    if (v[0] === ':') {\n      const key = v.slice(1)\n      return r.push((c, p) => { p[k] = c.app.res ? c.app.res(key) : key; return p })\n    }\n    if (v[0] === '<' && v[1] === '-') {\n      const ref = k + '_url'\n      const fctr = compileAttrValue(ref, v.slice(2).trim())\n      return r.push((c, p) => {\n        // custom assign\n        p['$' + k] = function () {\n          const old = this.$[ref]\n          const url = fctr(c, {})[ref]\n          if (url !== old) {\n            const ckey = k + '_counter'\n            const cbusy = k + '_busy'\n            const cerror = k + '_error'\n            const counter = (this.$[ckey] || 0) + 1\n            if (!this.app.fetch) {\n              const err = new Error('No App.fetch()')\n              console.error(err)\n              this.assign({[ref]: undefined, [cbusy]: false, [cerror]: err})\n              return\n            }\n            const cb = (error, data) => {\n              if (counter === this.$[ckey]) {\n                this.assign({[k]: data, [ref]: url, [cbusy]: false, [cerror]: error})\n              }\n            }\n            this.assign({[ref]: url, [cbusy]: true, [ckey]: counter, [cerror]: null})\n            setTimeout(() => this.app.fetch(url, this.$, cb), 10)\n          }\n        }\n        return p\n      })\n    }\n    if (v[0] === '-' && v[1] === '>') {\n      const fctr = compileAttrValue(k, v.slice(2).trim())\n      return r.push((c, p) => {\n        p[k] = (data) => (c.app.emit ? c.app.emit(fctr(c, {})[k], data) : console.error('No App.emit()'))\n        return p\n      })\n    }\n\n    r.push(compileAttrValue(k, v))\n  })\n  if (aProps) {\n    const fn = compileAttrs((new Map()).set('_', aProps))[0]\n    r.push((c, p) => { fn(c, p); return p })\n  }\n  return r\n}\n\nfunction compilePlaceholder (k, v) {\n  const keys = v.split('|')\n  const key = keys[0]\n  if (keys.length === 1) {\n    return (c, p) => { p[k] = c.get(key); return p }\n  } else {\n    const fnx = keys.slice(1).map(k => k.trim())\n    return (c, p) => { p[k] = fnx.reduce((r, k) => c.app.pipes && c.app.pipes[k] ? c.app.pipes[k](r) : r, c.get(key)); return p }\n  }\n}\n\nfunction compileAttrValue (k, v) {\n  if (!v.includes('{{')) {\n    const r = v === 'true' ? true : v === 'false' ? false : v\n    return (c, p) => { p[k] = r; return p }\n  }\n  if (v.match(RE_SINGLE_PLACEHOLDER)) {\n    return compilePlaceholder(k, v.slice(2, -2))\n  }\n  const fnx = []\n  v.replace(RE_PLACEHOLDER, (s, key) => fnx.push(compilePlaceholder('p' + fnx.length, key)))\n  return (c, p) => {\n    let idx = 0\n    const pp = {}\n    p[k] = v.replace(RE_PLACEHOLDER, (s, key) => {\n      const r = fnx[idx](c, pp)['p' + idx]\n      idx++\n      return r == null ? '' : r\n    })\n    return p\n  }\n}\n\n// ==========\n// XML Parse for templates. XML -> NodeTree\n// ----------\n\nexport const parseXML = (function () {\n  const RE_XML_ENTITY = /&#?[0-9a-z]{3,5};/g\n  const RE_XML_COMMENT = /<!--((?!-->)[\\s\\S])*-->/g\n  const RE_ATTRS = /([a-z][a-zA-Z0-9-:]+)=\"([^\"]*)\"/g\n  const RE_ESCAPE_XML_ENTITY = /[\"'&<>]/g\n  const RE_XML_TAG = /(<)(\\/?)([a-zA-Z][a-zA-Z0-9-:]*)((?:\\s+[a-z][a-zA-Z0-9-:]+=\"[^\"]*\")*)\\s*(\\/?)>/g\n\n  const SUBST_XML_ENTITY = {\n    amp: '&',\n    gt: '>',\n    lt: '<',\n    quot: `\"`,\n    nbsp: ' '\n  }\n  const ESCAPE_XML_ENTITY = {\n    34: '&quot;',\n    38: '&amp;',\n    39: '&#39;',\n    60: '&lt;',\n    62: '&gt;'\n  }\n  const FN_ESCAPE_XML_ENTITY = m => ESCAPE_XML_ENTITY[m.charCodeAt(0)]\n  const FN_XML_ENTITY = function (_) {\n    const s = _.substring(1, _.length - 1)\n    return s[0] === '#' ? String.fromCharCode(+s.slice(1)) : (SUBST_XML_ENTITY[s] || ' ')\n  }\n  const decodeXmlEntities = (s = '') => s.replace(RE_XML_ENTITY, FN_XML_ENTITY)\n  const escapeXml = (s) => !s ? '' : ('' + s).replace(RE_ESCAPE_XML_ENTITY, FN_ESCAPE_XML_ENTITY)\n\n  let UID = 1\n\n  const parseAttrs = (s) => {\n    const r = new Map()\n    if (!s) {\n      return r\n    }\n    while (1) {\n      let e = RE_ATTRS.exec(s)\n      if (!e) {\n        return r\n      }\n      r.set(e[1], decodeXmlEntities(e[2]))\n    }\n  }\n  const stringifyAttrs = (attrs) => {\n    if (!attrs || !attrs.size) {\n      return ''\n    }\n    const r = []\n    attrs.forEach((v, k) => {\n      if (v && k !== '#text') {\n        r.push(' ' + k + '=\"' + escapeXml(v) + '\"')\n      }\n    })\n    return r.join('')\n  }\n\n  class Node {\n    constructor (tag, attrs) {\n      this.uid = UID++\n      this.tag = tag || ''\n      this.attrs = attrs || new Map()\n      this.subs = []\n    }\n    getChild (index) {\n      return this.subs[index]\n    }\n    setText (text) {\n      this.attrs.set('#text', text)\n    }\n    addChild (tag, attrs) {\n      const e = new Node(tag, attrs)\n      this.subs.push(e)\n      return e\n    }\n    toString () {\n      return stringify(this, '')\n    }\n  }\n\n  function stringify ({ tag, attrs, subs }, tab) {\n    const sattrs = stringifyAttrs(attrs)\n    const ssubs = subs.map(c => stringify(c, `  ${tab}`)).join('\\n')\n    const text = attrs.get('#text')\n    const stext = text ? `  ${tab}${escapeXml(text)}` : ''\n    return `${tab}<${tag}${sattrs}` + (!ssubs && !stext ? '/>' : `>\\n${ssubs}${stext}\\n${tab}</${tag}>`)\n  }\n\n  return (_s, key) => {\n    const s = ('' + _s).trim().replace(RE_XML_COMMENT, '')\n    const ctx = [new Node()]\n    let lastIndex = 0\n    // head text omitted\n    while (1) {\n      let e = RE_XML_TAG.exec(s)\n      if (!e) {\n        break\n      }\n      // preceding text\n      const text = e.index && s.slice(lastIndex, e.index)\n      if (text && text.trim()) {\n        ctx[0].addChild('#text').setText(text)\n      }\n      // closing tag\n      if (e[2]) {\n        if (ctx[0].tag !== e[3]) {\n          throw new Error(\n            (key || '') + ' XML Parse closing tag does not match at: ' + e.index +\n            ' near ' + e.input.slice(Math.max(e.index - 15, 0), Math.min(e.index + 15, e.input.length)))\n        }\n        ctx.shift()\n      } else {\n        const elt = ctx[0].addChild(e[3], parseAttrs(e[4]))\n        // not single tag\n        if (!e[5]) {\n          ctx.unshift(elt)\n          if (ctx.length === 1) {\n            throw new Error('Parse error at: ' + e[0])\n          }\n        }\n      }\n      // up past index\n      lastIndex = RE_XML_TAG.lastIndex\n    }\n    // tail text omitted\n    return ctx[0].getChild(0)\n  }\n})()\n"],"sourceRoot":""}