{"version":3,"sources":["webpack://Dzi/webpack/bootstrap","webpack://Dzi/./lib/index.js"],"names":["launch","bootstrap","COUNTER","doc","window","document","ensureApi","app","objectApiStubs","emit","key","payload","console","error","fetch","target","cb","Error","pipes","resource","Object","keys","forEach","k","REGISTRY","Map","register","ctor","assign","name","NAME","exec","toString","text","TEMPLATE","prototype","getElementById","innerText","compiled","compile","parseXML","$TEMPLATE","resolve","$","set","types","render","elt","length","Component","staticTypes","concat","getElementsByTagName","filter","e","id","has","type","map","Bootstrap","body","$elt","meta","tag","props","subs","requestAnimationFrame","values","setters","v","textContent","disabled","class","replace","_","cl","fl","hasEq","eq","indexOf","setAttribute","selected","value","checked","data","$dataset","slice","setListener","ev","keyCode","$attributes","call","$owner","blur","Elmnt","m","parentElt","createTextNode","createElement","owner","lstnrs","$listeners","removeEventListener","p","parentElement","removeChild","delta","isDone","transclude","cursor","applyAttributes","before","nextSibling","firstChild","appendChild","insertBefore","theirs","mines","hasOwnProperty","undefined","prefixP","setter","listeners","T","removeAttribute","fn","addEventListener","get","delete","Ctor","d","defer","defered","push","init","f","$assignDepth","their","mine","toUpperCase","prevElt","constructor","posE","getter","posB","children","c","uid","done","size","ch","entries","componentCtor","parent","isInited","cc","Array","isArray","reduce","iff","each","else","partial","a","dataGetter","split","index","itemId","r","s","compileType","dtype","attrs","compileAttrs","aIf","neg","ifElse","find","ifThen","aEach","dataId","RE_SINGLE_PLACEHOLDER","RE_PLACEHOLDER","aProps","ref","fctr","compileAttrValue","trim","old","url","ckey","cbusy","cerror","counter","setTimeout","compilePlaceholder","fnx","includes","match","idx","pp","RE_XML_ENTITY","RE_XML_COMMENT","RE_ATTRS","RE_ESCAPE_XML_ENTITY","RE_XML_TAG","SUBST_XML_ENTITY","amp","gt","lt","quot","nbsp","ESCAPE_XML_ENTITY","FN_ESCAPE_XML_ENTITY","charCodeAt","FN_XML_ENTITY","substring","String","fromCharCode","decodeXmlEntities","escapeXml","UID","parseAttrs","stringifyAttrs","join","Node","stringify","tab","sattrs","ssubs","stext","_s","ctx","lastIndex","addChild","setText","input","Math","max","min","shift","unshift","getChild"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","let COUNTER = 1\nconst doc = window.document\n\n// ==========\n// ensure app API\n// ----------\nconst ensureApi = (app) => {\n  const objectApiStubs = {\n    // emit event:\n    emit (key, payload) {\n      console.error('app.emit() is not defined.')\n    },\n    // fetch\n    fetch (key, target, cb) {\n      cb(new Error('app.fetch() is not defined.'))\n    },\n    // pipes\n    pipes: {},\n    // resources\n    resource (key) {\n      return key\n    }\n  }\n  Object.keys(objectApiStubs).forEach(k => {\n    if (!app[k]) {\n      app[k] = objectApiStubs[k]\n    }\n  })\n  return app\n}\n\n// ==========\n// Type registry\n// ----------\nconst REGISTRY = new Map()\nconst register = ctor => {\n  // narrow non-function ctor\n  ctor = typeof ctor === 'function' ? ctor : Object.assign(function () {}, ctor)\n  // narrow name\n  const name = ctor.NAME = ctor.NAME ||\n    ctor.name ||\n    (/^function\\s+([\\w$]+)\\s*\\(/.exec(ctor.toString()) || [])[1] || ('$C' + COUNTER++)\n  // narrow template\n  const text = ctor.TEMPLATE ||\n    (ctor.prototype.TEMPLATE && ctor.prototype.TEMPLATE()) ||\n    (doc.getElementById(name) || {innerText: `<noop name=\"${name}\"/>`}).innerText\n  // compile\n  const compiled = compile(parseXML(text, name))\n  ctor.$TEMPLATE = $ => resolve(new Map(), $, compiled)\n  // register\n  REGISTRY.set(name, ctor)\n}\n\n// ==========\n// Bootstrap\n// ----------\n\n// bootstap a components tree and render immediately on <body/>\nexport function launch (...types) {\n  bootstrap(null, ...types).render()\n}\n// bootstap a components tree\nexport function bootstrap (elt, ...types) {\n  if (types.length === 0) {\n    types = [ Component ]\n  }\n  types.forEach(register)\n  // register transparent container: <ui:fragment>\n  register({NAME: 'fragment', TEMPLATE: '<ui:transclude/>'})\n  // collect and register `bare-template` definitions\n  const staticTypes = ([]).concat([...doc.getElementsByTagName('script')])\n    .filter(e => e.id && !REGISTRY.has(e.id) && e.type === 'text/x-template')\n  staticTypes.map(e => ({ NAME: e.id, TEMPLATE: e.innerText }))\n    .forEach(register)\n  // use `<body>` as mount element by default\n  return new Bootstrap(elt || doc.body, types[0])\n}\n\nclass Bootstrap {\n  constructor (elt, ctor) {\n    this.$elt = elt\n    this.meta = new Map()\n    this.meta.set(0, { tag: ctor.NAME, props: {}, subs: [] })\n  }\n  render () {\n    window.requestAnimationFrame(() => render(this, this.meta, this.$elt))\n  }\n}\n\n// ==========\n// Virtual DOM Element\n// ----------\nconst values = {\n  'true': true,\n  'false': false,\n  'null': null\n}\n\nconst setters = {\n  '#text': (e, k, v) => (e.textContent = v == null ? '' : v),\n  disabled: (e, k, v) => (e[k] = v ? true : null),\n  class: (e, k, v) => {\n    v = ('' + v).replace(/([a-z0-9]+):([a-z0-9.]*)(=([a-z0-9.]*))?\\b/g, (_, cl, fl, hasEq, eq) => {\n      const disabled = hasEq ? fl !== eq : ['', '0', 'false', 'off'].indexOf(fl) > -1\n      return disabled ? '' : cl\n    })\n    e.setAttribute(k, v)\n  },\n  selected: (e, k, v) => (e[k] = v ? true : null),\n  value: (e, k, v) => (e[k] = v),\n  checked: (e, k, v) => (e[k] = !!v),\n  data: (e, k, v) => { e.$dataset = Object.assign({}, v) },\n  'data*': (e, k, v) => { (e.$dataset || (e.$dataset = {}))[k.slice(5)] = v in values ? values[v] : v },\n  'enter': function (e, key, v) {\n    this.setListener('keyup', !v ? null : (ev) => {\n      if (ev.keyCode === 13) {\n        this.$attributes[key].call(this.$owner.$, { value: e.value, ...e.$dataset }, ev)\n      }\n      if (ev.keyCode === 13 || ev.keyCode === 27) {\n        e.blur()\n      }\n      return false\n    })\n  },\n  'toggle': function (e, key, v) {\n    this.setListener('change', !v ? null : (ev) => {\n      this.$attributes[key].call(this.$owner.$, { value: e.checked, ...e.$dataset }, ev)\n      return false\n    })\n  }\n}\n\nclass Elmnt {\n  constructor (m, parentElt) {\n    this.$ = m.tag === '#text' ? doc.createTextNode('') : doc.createElement(m.tag)\n    this.$attributes = {}\n    this.$owner = m.owner\n  }\n  init () {\n  }\n  done () {\n    const e = this.$\n    const lstnrs = this.$listeners\n    if (lstnrs) {\n      Object.keys(lstnrs).forEach(k => e.removeEventListener(k, lstnrs[k]))\n      this.$listeners = null\n    }\n    const p = e.parentElement\n    if (p) {\n      p.removeChild(e)\n    }\n    this.$elt = this.$attributes = this.$owner = this.parentElt = null\n  }\n  assign (delta) {\n    if (this.isDone) {\n      return\n    }\n    const e = this.$\n    const p = this.parentElt\n    if (this.transclude) {\n      e.cursor = null\n      render(this, this.transclude, e)\n      e.cursor = null\n    }\n    this.applyAttributes(delta)\n    const before = p.cursor ? p.cursor.nextSibling : p.firstChild\n    if (!before) {\n      p.appendChild(e)\n    } else if (e !== before) {\n      p.insertBefore(e, before)\n    }\n    p.cursor = e\n  }\n  applyAttributes (theirs) {\n    const e = this.$\n    const mines = this.$attributes\n    for (let key in mines) {\n      if (mines.hasOwnProperty(key) && theirs[key] === undefined) {\n        theirs[key] = null\n      }\n    }\n    for (let key in theirs) {\n      if (theirs.hasOwnProperty(key) && theirs[key] !== mines[key]) {\n        const value = theirs[key]\n        const prefixP = key.indexOf('-')\n        const setter = setters[prefixP === -1 ? key : key.slice(0, prefixP) + '*']\n        if (setter) {\n          setter.call(this, e, key, value)\n        } else {\n          if (typeof value === 'function' || (this.listeners && this.listeners.has(key))) {\n            const T = this\n            this.setListener(key, !value ? null : (ev) => {\n              T.$attributes[key].call(T.$owner.$, {value: e.value, ...e.$dataset}, ev)\n              return false\n            })\n          } else {\n            this.setAttribute(key, value)\n          }\n        }\n      }\n    }\n    this.$attributes = theirs\n  }\n  setAttribute (key, value) {\n    if (value != null) {\n      this.$.setAttribute(key, value)\n    } else {\n      this.$.removeAttribute(key)\n    }\n  }\n  setListener (key, fn) {\n    if (fn) {\n      if (!this.listeners) {\n        this.listeners = new Map()\n      }\n      if (!this.listeners.has(key)) {\n        this.$.addEventListener(key, fn, false)\n        this.listeners.set(key, fn)\n      }\n    } else {\n      if (this.listeners && this.listeners.has(key)) {\n        this.$.removeEventListener(key, this.listeners.get(key))\n        this.listeners.delete(key)\n      }\n    }\n  }\n}\n\n// ==========\n// Component\n// ----------\nclass Component {\n  constructor (m, Ctor) {\n    this.$ = new Ctor()\n    this.$.assign = (d) => this.assign(d)\n    this.$.defer = (fn) => {\n      if (fn) {\n        (this.defered || (this.defered = [])).push(fn)\n      }\n    }\n  }\n  init () {\n    if (this.$.init) {\n      this.$.init(this)\n    }\n  }\n  done () {\n    if (this.defered) {\n      this.defered.forEach(f => f.call(this, this))\n      delete this.defered\n    }\n  }\n  assign (delta) {\n    if (!delta || this.isDone) {\n      return\n    }\n    // prevent recursive invalidations\n    this.$assignDepth = (this.$assignDepth || 0) + 1\n    if (delta._) {\n      delta = {...delta._, ...delta, _: undefined}\n    }\n    // iterate payload\n    for (let k of Object.keys(delta)) {\n      const their = delta[k]\n      const mine = this.$[k]\n      if (k[0] === '$') {\n        their.call(this)\n        continue\n      }\n      if (their !== undefined && (their !== mine || (typeof their === 'object' && their !== null))) {\n        const setter = this.$['set' + k[0].toUpperCase() + k.slice(1)]\n        if (setter) {\n          setter.call(this.$, their)\n        } else {\n          this.$[k] = their\n        }\n      }\n    }\n    // prevent recursive invalidations\n    --this.$assignDepth\n    if (this.$assignDepth === 0) {\n      this.parentElt.cursor = this.prevElt\n      render(this, this.$.constructor.$TEMPLATE(this), this.parentElt)\n    }\n  }\n  get (k) {\n    let $ = this.$\n    if ($.get) {\n      return $.get(k)\n    }\n    let posE = k.indexOf('.')\n    if (posE === -1) {\n      const getter = $['get' + k[0].toUpperCase() + k.slice(1)]\n      const v = getter ? getter.call($, k) : $[k]\n      return v\n    }\n    let posB = 0\n    while (posE !== -1) {\n      $ = $[k.slice(posB, posE)]\n      if (!$) {\n        return\n      }\n      posB = posE + 1\n      posE = k.indexOf('.', posB)\n    }\n    return $[k.slice(posB)]\n  }\n}\n\n// ==========\n// Rendering. MetaTree -> ViewTree(Components,Elements)\n// ----------\nfunction render ($, meta, parentElt) {\n  if ($.isDone) {\n    return\n  }\n  // done\n  if ($.children) {\n    for (let c of $.children.values()) {\n      if (!meta.has(c.uid)) {\n        done(c)\n      }\n    }\n  }\n  if (meta.size) {\n    const ch = $.children || ($.children = new Map())\n    // create\n    for (let [uid, m] of meta.entries()) {\n      if (!ch.has(uid)) {\n        const componentCtor = REGISTRY.get(m.tag)\n        const c = componentCtor ? new Component(m, componentCtor) : new Elmnt(m)\n        c.uid = uid\n        c.parentElt = parentElt\n        c.parent = $\n        c.app = $.app || ensureApi(c.$)\n        ch.set(uid, c)\n      }\n    }\n    // assign\n    for (let [uid, m] of meta.entries()) {\n      const c = ch.get(uid)\n      c.transclude = m.subs\n      c.prevElt = parentElt.cursor\n      c.assign(m.props)\n    }\n    // init\n    for (let c of ch.values()) {\n      if (!c.isInited) {\n        c.isInited = true\n        c.init()\n      }\n    }\n  }\n}\n// done\nfunction done (c) {\n  if (c.isDone) {\n    return\n  }\n  c.isDone = true\n  c.done()\n  if (c.children) {\n    for (let cc of c.children.values()) {\n      done(cc)\n    }\n    c.children = null\n  }\n  if (c.parent) {\n    c.parent.children.delete(c.uid)\n    c.parent = null\n  }\n  if (c.app) {\n    c.app = null\n  }\n}\n\n// ==========\n// Template Resolution. GeneratorTree + Data -> MetaTree\n// ----------\n\nfunction resolve (map, c, meta) {\n  if (!meta) {\n    return map\n  }\n  if (Array.isArray(meta)) {\n    return meta.reduce((m, e) => resolve(m, c, e), map)\n  }\n  const { type, props, subs, uid, iff, each, key } = meta\n  const tag = type(c)\n  if (iff && !iff(c)) {\n    return resolve(map, c, iff.else)\n  }\n\n  if (tag === 'transclude') {\n    const partial = props.reduce((a, f) => f(c, a), {}).key\n    c.transclude.forEach((v, k) => {\n      if (partial ? v.key === partial : !v.key) {\n        map.set(k, v)\n      }\n    })\n    return map\n  }\n  if (each) {\n    const data = each.dataGetter(c)\n    return !data || !data.length ? map : (data.reduce ? data : ('' + data).split(',')).reduce((m, d, index) => {\n      c.$[each.itemId] = d\n      c.$[each.itemId + 'Index'] = index\n      const id = `${uid}-$${d.id || index}`\n      return resolve(m, c, { type, props, subs, uid: id })\n    }, map)\n  }\n  const r = {\n    owner: c,\n    tag,\n    props: {},\n    key,\n    subs: subs.length ? subs.reduce((m, s) => resolve(m, c, s), new Map()) : null\n  }\n  for (let p of props) {\n    p(c, r.props)\n  }\n  return map.set(tag + uid, r)\n}\n\n// ==========\n// Template Compilation. NodeTree -> GeneratorTree\n// ----------\n\nfunction compileType (tag) {\n  const dtype = tag.slice(0, 3) === 'ui:' ? tag.slice(3) : null\n  return dtype ? (dtype === 'fragment' || dtype === 'transclude' ? c => dtype : c => c.get(dtype)) : c => tag\n}\n\nfunction compile ({ tag, attrs, uid, subs }) {\n  const r = { uid, type: compileType(tag), props: compileAttrs(attrs), key: attrs.get('ui:key') }\n\n  const aIf = attrs.get('ui:if')\n  if (aIf) {\n    const neg = aIf[0] === '!' ? aIf.slice(1) : null\n    r.iff = neg ? c => !c.get(neg) : c => !!c.get(aIf)\n    if (subs.length) {\n      const ifElse = subs.find(e => e.tag === 'ui:else')\n      const ifThen = subs.find(e => e.tag === 'ui:then')\n      if (ifElse) {\n        r.iff.else = compile(ifElse).subs\n        subs = ifThen ? ifThen.subs : subs.filter(e => e !== ifElse)\n      } else if (ifThen) {\n        subs = ifThen.subs\n      }\n    }\n  }\n\n  const aEach = attrs.get('ui:each')\n  if (aEach) {\n    const [ itemId, , dataId ] = aEach.split(' ')\n    const dataGetter = dataId[0] === ':' ? c => c.app.resource(dataId.slice(1)) : (c) => c.get(dataId)\n    r.each = { itemId, dataGetter }\n  }\n\n  r.subs = subs.map(compile)\n  return r\n}\n\nconst RE_SINGLE_PLACEHOLDER = /^\\{\\{([a-zA-Z0-9._$|]+)\\}\\}$/\nconst RE_PLACEHOLDER = /\\{\\{([a-zA-Z0-9._$|]+)\\}\\}/g\nfunction compileAttrs (attrs) {\n  const r = []\n  let aProps = null\n  attrs.forEach((v, k) => {\n    if (k.slice(0, 3) === 'ui:') {\n      if (k === 'ui:props') {\n        aProps = v\n      }\n      return\n    }\n    // localize by key\n    if (v[0] === ':') {\n      const key = v.slice(1)\n      return r.push((c, p) => { p[k] = c.app.resource(key); return p })\n    }\n    if (v[0] === '<' && v[1] === '-') {\n      const ref = k + '_url'\n      const fctr = compileAttrValue(ref, v.slice(2).trim())\n      return r.push((c, p) => {\n        // custom assign\n        p['$' + k] = function () {\n          const old = this.$[ref]\n          const url = fctr(c, {})[ref]\n          if (url !== old) {\n            const ckey = k + '_counter'\n            const cbusy = k + '_busy'\n            const cerror = k + '_error'\n            const counter = (this.$[ckey] || 0) + 1\n            const cb = (error, data) => {\n              if (counter === this.$[ckey]) {\n                this.assign({[k]: data, [ref]: url, [cbusy]: false, [cerror]: error})\n              }\n            }\n            this.assign({[ref]: url, [cbusy]: true, [ckey]: counter, [cerror]: null})\n            setTimeout(() => this.app.fetch(url, this.$, cb), 10)\n          }\n        }\n        return p\n      })\n    }\n    if (v[0] === '-' && v[1] === '>') {\n      const fctr = compileAttrValue(k, v.slice(2).trim())\n      return r.push((c, p) => {\n        p[k] = (data) => c.app.emit(fctr(c, {})[k], data)\n        return p\n      })\n    }\n\n    r.push(compileAttrValue(k, v))\n  })\n  if (aProps) {\n    const fn = compileAttrs((new Map()).set('_', aProps))[0]\n    r.push((c, p) => { fn(c, p); return p })\n  }\n  return r\n}\n\nfunction compilePlaceholder (k, v) {\n  const keys = v.split('|')\n  const key = keys[0]\n  if (keys.length === 1) {\n    return (c, p) => { p[k] = c.get(key); return p }\n  } else {\n    const fnx = keys.slice(1).map(k => k.trim())\n    return (c, p) => { p[k] = fnx.reduce((r, k) => c.app.pipes[k] ? c.app.pipes[k](r) : r, c.get(key)); return p }\n  }\n}\n\nfunction compileAttrValue (k, v) {\n  if (!v.includes('{{')) {\n    const r = v === 'true' ? true : v === 'false' ? false : v\n    return (c, p) => { p[k] = r; return p }\n  }\n  if (v.match(RE_SINGLE_PLACEHOLDER)) {\n    return compilePlaceholder(k, v.slice(2, -2))\n  }\n  const fnx = []\n  v.replace(RE_PLACEHOLDER, (s, key) => fnx.push(compilePlaceholder('p' + fnx.length, key)))\n  return (c, p) => {\n    let idx = 0\n    const pp = {}\n    p[k] = v.replace(RE_PLACEHOLDER, (s, key) => {\n      const r = fnx[idx](c, pp)['p' + idx]\n      idx++\n      return r == null ? '' : r\n    })\n    return p\n  }\n}\n\n// ==========\n// XML Parse for templates. XML -> NodeTree\n// ----------\n\nexport const parseXML = (function () {\n  const RE_XML_ENTITY = /&#?[0-9a-z]{3,5};/g\n  const RE_XML_COMMENT = /<!--((?!-->)[\\s\\S])*-->/g\n  const RE_ATTRS = /([a-z][a-zA-Z0-9-:]+)=\"([^\"]*)\"/g\n  const RE_ESCAPE_XML_ENTITY = /[\"'&<>]/g\n  const RE_XML_TAG = /(<)(\\/?)([a-zA-Z][a-zA-Z0-9-:]*)((?:\\s+[a-z][a-zA-Z0-9-:]+=\"[^\"]*\")*)\\s*(\\/?)>/g\n\n  const SUBST_XML_ENTITY = {\n    amp: '&',\n    gt: '>',\n    lt: '<',\n    quot: `\"`,\n    nbsp: ' '\n  }\n  const ESCAPE_XML_ENTITY = {\n    34: '&quot;',\n    38: '&amp;',\n    39: '&#39;',\n    60: '&lt;',\n    62: '&gt;'\n  }\n  const FN_ESCAPE_XML_ENTITY = m => ESCAPE_XML_ENTITY[m.charCodeAt(0)]\n  const FN_XML_ENTITY = function (_) {\n    const s = _.substring(1, _.length - 1)\n    return s[0] === '#' ? String.fromCharCode(+s.slice(1)) : (SUBST_XML_ENTITY[s] || ' ')\n  }\n  const decodeXmlEntities = (s = '') => s.replace(RE_XML_ENTITY, FN_XML_ENTITY)\n  const escapeXml = (s) => !s ? '' : ('' + s).replace(RE_ESCAPE_XML_ENTITY, FN_ESCAPE_XML_ENTITY)\n\n  let UID = 1\n\n  const parseAttrs = (s) => {\n    const r = new Map()\n    if (!s) {\n      return r\n    }\n    while (1) {\n      let e = RE_ATTRS.exec(s)\n      if (!e) {\n        return r\n      }\n      r.set(e[1], decodeXmlEntities(e[2]))\n    }\n  }\n  const stringifyAttrs = (attrs) => {\n    if (!attrs || !attrs.size) {\n      return ''\n    }\n    const r = []\n    attrs.forEach((v, k) => {\n      if (v && k !== '#text') {\n        r.push(' ' + k + '=\"' + escapeXml(v) + '\"')\n      }\n    })\n    return r.join('')\n  }\n\n  class Node {\n    constructor (tag, attrs) {\n      this.uid = UID++\n      this.tag = tag || ''\n      this.attrs = attrs || new Map()\n      this.subs = []\n    }\n    getChild (index) {\n      return this.subs[index]\n    }\n    setText (text) {\n      this.attrs.set('#text', text)\n    }\n    addChild (tag, attrs) {\n      const e = new Node(tag, attrs)\n      this.subs.push(e)\n      return e\n    }\n    toString () {\n      return stringify(this, '')\n    }\n  }\n\n  function stringify ({ tag, attrs, subs }, tab) {\n    const sattrs = stringifyAttrs(attrs)\n    const ssubs = subs.map(c => stringify(c, `  ${tab}`)).join('\\n')\n    const text = attrs.get('#text')\n    const stext = text ? `  ${tab}${escapeXml(text)}` : ''\n    return `${tab}<${tag}${sattrs}` + (!ssubs && !stext ? '/>' : `>\\n${ssubs}${stext}\\n${tab}</${tag}>`)\n  }\n\n  return (_s, key) => {\n    const s = ('' + _s).trim().replace(RE_XML_COMMENT, '')\n    const ctx = [new Node()]\n    let lastIndex = 0\n    // head text omitted\n    while (1) {\n      let e = RE_XML_TAG.exec(s)\n      if (!e) {\n        break\n      }\n      // preceding text\n      const text = e.index && s.slice(lastIndex, e.index)\n      if (text && text.trim()) {\n        ctx[0].addChild('#text').setText(text)\n      }\n      // closing tag\n      if (e[2]) {\n        if (ctx[0].tag !== e[3]) {\n          throw new Error(\n            (key || '') + ' XML Parse closing tag does not match at: ' + e.index +\n            ' near ' + e.input.slice(Math.max(e.index - 15, 0), Math.min(e.index + 15, e.input.length)))\n        }\n        ctx.shift()\n      } else {\n        const elt = ctx[0].addChild(e[3], parseAttrs(e[4]))\n        // not single tag\n        if (!e[5]) {\n          ctx.unshift(elt)\n          if (ctx.length === 1) {\n            throw new Error('Parse error at: ' + e[0])\n          }\n        }\n      }\n      // up past index\n      lastIndex = RE_XML_TAG.lastIndex\n    }\n    // tail text omitted\n    return ctx[0].getChild(0)\n  }\n})()\n"],"sourceRoot":""}