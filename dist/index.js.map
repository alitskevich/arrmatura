{"version":3,"sources":["webpack://Dzi/webpack/bootstrap","webpack://Dzi/./lib/component.js","webpack://Dzi/./lib/dom.js","webpack://Dzi/./lib/index.js","webpack://Dzi/./lib/xml.js"],"names":["Component","m","Ctor","$","init","defered","forEach","f","call","delta","isDone","$assignDepth","_","undefined","Object","keys","k","their","mine","setter","toUpperCase","slice","parentElt","cursor","prevElt","render","values","doc","window","document","setters","e","v","textContent","disabled","class","replace","cl","fl","hasEq","eq","indexOf","setAttribute","selected","value","checked","data","$dataset","assign","key","setListener","ev","keyCode","$attributes","$owner","blur","Elmnt","tag","owner","createTextNode","createElement","lstnrs","$listeners","removeEventListener","p","parentElement","removeChild","$elt","transclude","renderInnerContent","applyAttributes","before","nextSibling","firstChild","appendChild","insertBefore","theirs","mines","hasOwnProperty","prefixP","listeners","has","T","removeAttribute","fn","Map","addEventListener","set","get","delete","launch","bootstrap","COUNTER","ensureApi","app","objectApiStubs","emit","payload","console","error","fetchInto","target","propName","Error","pipes","resource","REGISTRY","defer","push","__assign__","d","register","ctor","name","NAME","exec","toString","text","TEMPLATE","prototype","getElementById","innerText","compiledTemplate","compile","__render__","resolve","types","elt","length","Element","staticTypes","concat","getElementsByTagName","filter","id","type","map","Bootstrap","body","meta","props","subs","requestAnimationFrame","children","c","uid","done","size","ch","entries","componentCtor","parent","isInited","cc","Array","isArray","reduce","iff","each","else","partial","a","dataGetter","split","index","itemId","r","s","prop","posE","getter","posB","compileType","dtype","attrs","compileAttrs","aIf","neg","ifElse","find","ifThen","aEach","dataId","RE_SINGLE_PLACEHOLDER","RE_PLACEHOLDER","aProps","fctr","compileAttrValue","trim","url","old","fetchUrls","setTimeout","compilePlaceholder","fnx","includes","match","idx","pp","RE_XML_ENTITY","RE_XML_COMMENT","RE_ATTRS","RE_ESCAPE_XML_ENTITY","RE_XML_TAG","SINGLE_TAGS","SUBST_XML_ENTITY","amp","gt","lt","quot","nbsp","ESCAPE_XML_ENTITY","FN_ESCAPE_XML_ENTITY","charCodeAt","FN_XML_ENTITY","substring","String","fromCharCode","decodeXmlEntities","escapeXml","UID","parseAttrs","stringifyAttrs","join","Node","stringify","tab","sattrs","ssubs","stext","parseXML","_s","ctx","lastIndex","addChild","setText","input","Math","max","min","shift","unshift","getChild"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","// ==========\n// Component\n// ----------\nexport class Component {\n    constructor (m, Ctor) {\n      this.$ = new Ctor()\n      // mutual reference\n      this.$.$ = this\n    }\n    init () {\n      if (this.$.init) {\n        this.$.init(this)\n      }\n    }\n    done () {\n      if (this.defered) {\n        this.defered.forEach(f => f.call(this, this))\n        delete this.defered\n      }\n      this.$ = this.$.$ = null\n    }\n    assign (delta) {\n      if (!delta || this.isDone) {\n        return\n      }\n      // prevent recursive invalidations\n      this.$assignDepth = (this.$assignDepth || 0) + 1\n      if (delta._) {\n        delta = {...delta._, ...delta, _: undefined}\n      }\n      // iterate payload\n      for (let k of Object.keys(delta)) {\n        const their = delta[k]\n        const mine = this.$[k]\n        if (k[0] === '$') {\n          their.call(this)\n        }\n        if (their !== undefined && (their !== mine || (typeof their === 'object' && their !== null))) {\n          const setter = this.$['set' + k[0].toUpperCase() + k.slice(1)]\n          if (setter) {\n            setter.call(this.$, their)\n          } else {\n            this.$[k] = their\n          }\n        }\n      }\n      // prevent recursive invalidations\n      --this.$assignDepth\n      if (this.$assignDepth === 0) {\n        this.parentElt.cursor = this.prevElt\n        this.$.render(this)\n      }\n    }\n  }\n  ","// ==========\n// Virtual DOM Element\n// ----------\nconst values = {\n  'true': true,\n  'false': false,\n  'null': null\n}\nconst doc = window.document\n\nconst setters = {\n  '#text': (e, k, v) => (e.textContent = v == null ? '' : v),\n  disabled: (e, k, v) => (e[k] = v ? true : null),\n  class: (e, k, v) => {\n    v = ('' + v).replace(/([a-z0-9]+):([a-z0-9.]*)(=([a-z0-9.]*))?\\b/g, (_, cl, fl, hasEq, eq) => {\n      const disabled = hasEq ? fl !== eq : ['', '0', 'false', 'off'].indexOf(fl) > -1\n      return disabled ? '' : cl\n    })\n    e.setAttribute(k, v)\n  },\n  selected: (e, k, v) => (e[k] = v ? true : null),\n  value: (e, k, v) => (e[k] = v),\n  checked: (e, k, v) => (e[k] = !!v),\n  data: (e, k, v) => { e.$dataset = Object.assign({}, v) },\n  'data*': (e, k, v) => { (e.$dataset || (e.$dataset = {}))[k.slice(5)] = v in values ? values[v] : v },\n  'enter': function (e, key, v) {\n    this.setListener('keyup', !v ? null : (ev) => {\n      if (ev.keyCode === 13) {\n        this.$attributes[key].call(this.$owner.$, { value: e.value, ...e.$dataset }, ev)\n      }\n      if (ev.keyCode === 13 || ev.keyCode === 27) {\n        e.blur()\n      }\n      return false\n    })\n  },\n  'toggle': function (e, key, v) {\n    this.setListener('change', !v ? null : (ev) => {\n      this.$attributes[key].call(this.$owner.$, { value: e.checked, ...e.$dataset }, ev)\n      return false\n    })\n  }\n}\n\nexport class Elmnt {\n  constructor ({tag, owner}) {\n    this.$ = tag === '#text' ? doc.createTextNode('') : doc.createElement(tag)\n    this.$attributes = {}\n    this.$owner = owner\n  }\n  init () {\n  }\n  done () {\n    const e = this.$\n    const lstnrs = this.$listeners\n    if (lstnrs) {\n      Object.keys(lstnrs).forEach(k => e.removeEventListener(k, lstnrs[k]))\n      this.$listeners = null\n    }\n    const p = e.parentElement\n    if (p) {\n      p.removeChild(e)\n    }\n    this.$elt = this.$attributes = this.$owner = this.parentElt = null\n  }\n  assign (delta) {\n    if (this.isDone) {\n      return\n    }\n    const e = this.$\n    const p = this.parentElt\n    if (this.transclude) {\n      e.cursor = null\n      this.renderInnerContent()\n      e.cursor = null\n    }\n    this.applyAttributes(delta)\n    const before = p.cursor ? p.cursor.nextSibling : p.firstChild\n    if (!before) {\n      p.appendChild(e)\n    } else if (e !== before) {\n      p.insertBefore(e, before)\n    }\n    p.cursor = e\n  }\n  applyAttributes (theirs) {\n    const e = this.$\n    const mines = this.$attributes\n    for (let key in mines) {\n      if (mines.hasOwnProperty(key) && theirs[key] === undefined) {\n        theirs[key] = null\n      }\n    }\n    for (let key in theirs) {\n      if (theirs.hasOwnProperty(key) && theirs[key] !== mines[key]) {\n        const value = theirs[key]\n        const prefixP = key.indexOf('-')\n        const setter = setters[prefixP === -1 ? key : key.slice(0, prefixP) + '*']\n        if (setter) {\n          setter.call(this, e, key, value)\n        } else {\n          if (typeof value === 'function' || (this.listeners && this.listeners.has(key))) {\n            const T = this\n            this.setListener(key, !value ? null : (ev) => {\n              T.$attributes[key].call(T.$owner.$, {value: e.value, ...e.$dataset}, ev)\n              return false\n            })\n          } else {\n            this.setAttribute(key, value)\n          }\n        }\n      }\n    }\n    this.$attributes = theirs\n  }\n  setAttribute (key, value) {\n    if (value != null) {\n      this.$.setAttribute(key, value)\n    } else {\n      this.$.removeAttribute(key)\n    }\n  }\n  setListener (key, fn) {\n    if (fn) {\n      if (!this.listeners) {\n        this.listeners = new Map()\n      }\n      if (!this.listeners.has(key)) {\n        this.$.addEventListener(key, fn, false)\n        this.listeners.set(key, fn)\n      }\n    } else {\n      if (this.listeners && this.listeners.has(key)) {\n        this.$.removeEventListener(key, this.listeners.get(key))\n        this.listeners.delete(key)\n      }\n    }\n  }\n  }\n","import {parseXML} from './xml.js'\nimport {Elmnt} from './dom.js'\nimport {Component} from './component.js'\nexport {Component} from './component.js'\n\nlet COUNTER = 1\nconst doc = window.document\n\n// ==========\n// ensure app API\n// ----------\nconst ensureApi = (app) => {\n  const objectApiStubs = {\n    // emit event:\n    emit (key, payload) {\n      console.error('app.emit() is not defined.')\n    },\n    // fetch\n    fetchInto (key, target, propName) {\n      target.assign({error: new Error('app.fetch() is not defined.')})\n    },\n    // pipes\n    pipes: {},\n    // resources\n    resource (key) {\n      return key\n    }\n  }\n  Object.keys(objectApiStubs).forEach(k => {\n    if (!app[k]) {\n      app[k] = objectApiStubs[k]\n    }\n  })\n  return app\n}\n\n// ==========\n// Type registry\n// ----------\nconst REGISTRY = new Map()\n\nfunction defer (fn) {\n  if (fn) {\n    (this.$.defered || (this.$.defered = [])).push(fn)\n  }\n}\n\nfunction __assign__ (d) {\n  this.$.assign(d)\n}\n\nconst register = ctor => {\n  // narrow non-function ctor\n  ctor = typeof ctor === 'function' ? ctor : Object.assign(function () {}, ctor)\n  // narrow name\n  const name = ctor.NAME = ctor.NAME ||\n    ctor.name ||\n    (/^function\\s+([\\w$]+)\\s*\\(/.exec(ctor.toString()) || [])[1] || ('$C' + COUNTER++)\n  // narrow template\n  const text = ctor.TEMPLATE ||\n    (ctor.prototype.TEMPLATE && ctor.prototype.TEMPLATE()) ||\n    (doc.getElementById(name) || {innerText: `<noop name=\"${name}\"/>`}).innerText\n  // compile\n  const compiledTemplate = compile(parseXML(text, name))\n  function __render__ () {\n    render(this.$, resolve(new Map(), this.$, compiledTemplate), this.$.parentElt)\n  }\n  // patch with framework facilities:\n  Object.assign(ctor.prototype, {\n    __assign__,\n    __render__,\n    assign: ctor.prototype.assign || __assign__,\n    render: ctor.prototype.render || __render__,\n    defer\n  })\n  // register\n  REGISTRY.set(name, ctor)\n}\n\n// ==========\n// Bootstrap\n// ----------\n\n// bootstap a components tree and render immediately on <body/>\nexport function launch (...types) {\n  bootstrap(null, ...types).render()\n}\n// bootstap a components tree\nexport function bootstrap (elt, ...types) {\n  if (types.length === 0) {\n    types = [ Component ]\n  }\n  types.forEach(register)\n  // register transparent container: <ui:fragment>\n  register({NAME: 'fragment', TEMPLATE: '<ui:transclude/>'})\n  // make reference to render()\n  Elmnt.prototype.renderInnerContent = function () { render(this, this.transclude, this.$) }\n  Component.Element = Elmnt\n  // collect and register `bare-template` definitions\n  const staticTypes = ([]).concat([...doc.getElementsByTagName('script')])\n    .filter(e => e.id && !REGISTRY.has(e.id) && e.type === 'text/x-template')\n  staticTypes.map(e => ({ NAME: e.id, TEMPLATE: e.innerText }))\n    .forEach(register)\n  // use `<body>` as mount element by default\n  return new Bootstrap(elt || doc.body, types[0])\n}\n\nclass Bootstrap {\n  constructor (elt, ctor) {\n    this.$elt = elt\n    this.meta = new Map()\n    this.meta.set(0, { tag: ctor.NAME, props: {}, subs: [] })\n  }\n  render () {\n    window.requestAnimationFrame(() => render(this, this.meta, this.$elt))\n  }\n}\n\n// ==========\n// Rendering. MetaTree -> ViewTree(Components,Elements)\n// ----------\nfunction render ($, meta, parentElt) {\n  if ($.isDone) {\n    return\n  }\n  // done\n  if ($.children) {\n    for (let c of $.children.values()) {\n      if (!meta.has(c.uid)) {\n        done(c)\n      }\n    }\n  }\n  if (meta.size) {\n    const ch = $.children || ($.children = new Map())\n    // create\n    for (let [uid, m] of meta.entries()) {\n      if (!ch.has(uid)) {\n        const componentCtor = REGISTRY.get(m.tag)\n        const c = componentCtor ? new Component(m, componentCtor) : new Component.Element(m)\n        c.uid = uid\n        c.parentElt = parentElt\n        c.parent = $\n        c.app = $.app || ensureApi(c.$)\n        ch.set(uid, c)\n      }\n    }\n    // assign\n    for (let [uid, m] of meta.entries()) {\n      const c = ch.get(uid)\n      c.transclude = m.subs\n      c.prevElt = parentElt.cursor\n      c.assign(m.props)\n    }\n    // init\n    for (let c of ch.values()) {\n      if (!c.isInited) {\n        c.isInited = true\n        c.init()\n      }\n    }\n  }\n}\n// done\nfunction done (c) {\n  if (c.isDone) {\n    return\n  }\n  c.isDone = true\n  c.done()\n  if (c.children) {\n    for (let cc of c.children.values()) {\n      done(cc)\n    }\n    c.children = null\n  }\n  if (c.parent) {\n    c.parent.children.delete(c.uid)\n    c.parent = null\n  }\n  if (c.app) {\n    c.app = null\n  }\n}\n\n// ==========\n// Template Resolution. GeneratorTree + Data -> MetaTree\n// ----------\n\nfunction resolve (map, c, meta) {\n  if (!meta) {\n    return map\n  }\n  if (Array.isArray(meta)) {\n    return meta.reduce((m, e) => resolve(m, c, e), map)\n  }\n  const { type, props, subs, uid, iff, each, key } = meta\n  const tag = type(c)\n  if (iff && !iff(c)) {\n    return resolve(map, c, iff.else)\n  }\n\n  if (tag === 'transclude') {\n    const partial = props.reduce((a, f) => f(c, a), {}).key\n    c.transclude.forEach((v, k) => {\n      if (partial ? v.key === partial : !v.key) {\n        map.set(k, v)\n      }\n    })\n    return map\n  }\n  if (each) {\n    const data = each.dataGetter(c)\n    return !data || !data.length ? map : (data.reduce ? data : ('' + data).split(',')).reduce((m, d, index) => {\n      c.$[each.itemId] = d\n      c.$[each.itemId + 'Index'] = index\n      const id = `${uid}-$${d.id || index}`\n      return resolve(m, c, { type, props, subs, uid: id })\n    }, map)\n  }\n  const r = {\n    owner: c,\n    tag,\n    props: {},\n    key,\n    subs: subs.length ? subs.reduce((m, s) => resolve(m, c, s), new Map()) : null\n  }\n  for (let p of props) {\n    p(c, r.props)\n  }\n  return map.set(tag + uid, r)\n}\n\nfunction prop (c, k) {\n  let $ = c.$\n  if ($.get) {\n    return $.get(k)\n  }\n  let posE = k.indexOf('.')\n  if (posE === -1) {\n    const getter = $['get' + k[0].toUpperCase() + k.slice(1)]\n    const v = getter ? getter.call($, k) : $[k]\n    return v\n  }\n  let posB = 0\n  // dig\n  while (posE !== -1) {\n    $ = $[k.slice(posB, posE)]\n    if (!$) {\n      return\n    }\n    posB = posE + 1\n    posE = k.indexOf('.', posB)\n  }\n  return $[k.slice(posB)]\n}\n// ==========\n// Template Compilation. NodeTree -> GeneratorTree\n// ----------\n\nfunction compileType (tag) {\n  const dtype = tag.slice(0, 3) === 'ui:' ? tag.slice(3) : null\n  return dtype ? (dtype === 'fragment' || dtype === 'transclude' ? c => dtype : c => prop(c, dtype)) : c => tag\n}\n\nfunction compile ({ tag, attrs, uid, subs }) {\n  const r = { uid, type: compileType(tag), props: compileAttrs(attrs), key: attrs.get('ui:key') }\n\n  const aIf = attrs.get('ui:if')\n  if (aIf) {\n    const neg = aIf[0] === '!' ? aIf.slice(1) : null\n    r.iff = neg ? c => !prop(c, neg) : c => !!prop(c, aIf)\n    if (subs.length) {\n      const ifElse = subs.find(e => e.tag === 'ui:else')\n      const ifThen = subs.find(e => e.tag === 'ui:then')\n      if (ifElse) {\n        r.iff.else = compile(ifElse).subs\n        subs = ifThen ? ifThen.subs : subs.filter(e => e !== ifElse)\n      } else if (ifThen) {\n        subs = ifThen.subs\n      }\n    }\n  }\n\n  const aEach = attrs.get('ui:each')\n  if (aEach) {\n    const [ itemId, , dataId ] = aEach.split(' ')\n    const dataGetter = dataId[0] === ':' ? c => c.app.resource(dataId.slice(1)) : (c) => prop(c, dataId)\n    r.each = { itemId, dataGetter }\n  }\n\n  r.subs = subs.map(compile)\n  return r\n}\n\nconst RE_SINGLE_PLACEHOLDER = /^\\{\\{([a-zA-Z0-9._$|]+)\\}\\}$/\nconst RE_PLACEHOLDER = /\\{\\{([a-zA-Z0-9._$|]+)\\}\\}/g\nfunction compileAttrs (attrs) {\n  const r = []\n  let aProps = null\n  attrs.forEach((v, k) => {\n    if (k.slice(0, 3) === 'ui:') {\n      if (k === 'ui:props') {\n        aProps = v\n      }\n      return\n    }\n    // localize by key\n    if (v[0] === ':') {\n      const key = v.slice(1)\n      return r.push((c, p) => { p[k] = c.app.resource(key); return p })\n    }\n    if (v[0] === '<' && v[1] === '-') {\n      const fctr = compileAttrValue(k, v.slice(2).trim())\n      return r.push((c, p) => {\n        p['$' + k] = function () {\n          const url = fctr(c, {})[k]\n          const old = (this.$.fetchUrls || (this.$.fetchUrls = {}))[k]\n          if (url !== old) {\n            this.$.fetchUrls[k] = url\n            setTimeout(() => this.app && this.app.fetchInto(url, this.$, k), 10)\n          }\n        }\n        return p\n      })\n    }\n    if (v[0] === '-' && v[1] === '>') {\n      const fctr = compileAttrValue(k, v.slice(2).trim())\n      return r.push((c, p) => {\n        p[k] = (data) => c.app.emit(fctr(c, {})[k], data)\n        return p\n      })\n    }\n\n    r.push(compileAttrValue(k, v))\n  })\n  if (aProps) {\n    const fn = compileAttrs((new Map()).set('_', aProps))[0]\n    r.push((c, p) => {\n      fn(c, p)\n      return p\n    })\n  }\n  return r\n}\n\nfunction compilePlaceholder (k, v) {\n  const keys = v.split('|')\n  const key = keys[0]\n  if (keys.length === 1) {\n    return (c, p) => { p[k] = prop(c, key); return p }\n  } else {\n    const fnx = keys.slice(1).map(k => k.trim())\n    return (c, p) => { p[k] = fnx.reduce((r, k) => c.app.pipes[k] ? c.app.pipes[k](r, c) : r, prop(c, key)); return p }\n  }\n}\n\nfunction compileAttrValue (k, v) {\n  if (!v.includes('{{')) {\n    const r = v === 'true' ? true : v === 'false' ? false : v\n    return (c, p) => { p[k] = r; return p }\n  }\n  if (v.match(RE_SINGLE_PLACEHOLDER)) {\n    return compilePlaceholder(k, v.slice(2, -2))\n  }\n  const fnx = []\n  v.replace(RE_PLACEHOLDER, (s, key) => fnx.push(compilePlaceholder('p' + fnx.length, key)))\n  return (c, p) => {\n    let idx = 0\n    const pp = {}\n    p[k] = v.replace(RE_PLACEHOLDER, (s, key) => {\n      const r = fnx[idx](c, pp)['p' + idx]\n      idx++\n      return r == null ? '' : r\n    })\n    return p\n  }\n}\n","// ==========\n// XML Parse for templates. XML -> NodeTree\n// ----------\nconst RE_XML_ENTITY = /&#?[0-9a-z]{3,5};/g\nconst RE_XML_COMMENT = /<!--((?!-->)[\\s\\S])*-->/g\nconst RE_ATTRS = /([a-z][a-zA-Z0-9-:]+)=\"([^\"]*)\"/g\nconst RE_ESCAPE_XML_ENTITY = /[\"'&<>]/g\nconst RE_XML_TAG = /(<)(\\/?)([a-zA-Z][a-zA-Z0-9-:]*)((?:\\s+[a-z][a-zA-Z0-9-:]+=\"[^\"]*\")*)\\s*(\\/?)>/g\nconst SINGLE_TAGS = 'img input br'.split(' ').reduce((r, e) => { r[e] = 1; return r }, {})\nconst SUBST_XML_ENTITY = {\n    amp: '&',\n    gt: '>',\n    lt: '<',\n    quot: `\"`,\n    nbsp: ' '\n}\nconst ESCAPE_XML_ENTITY = {\n    34: '&quot;',\n    38: '&amp;',\n    39: '&#39;',\n    60: '&lt;',\n    62: '&gt;'\n}\nconst FN_ESCAPE_XML_ENTITY = m => ESCAPE_XML_ENTITY[m.charCodeAt(0)]\nconst FN_XML_ENTITY = function (_) {\n    const s = _.substring(1, _.length - 1)\n    return s[0] === '#' ? String.fromCharCode(+s.slice(1)) : (SUBST_XML_ENTITY[s] || ' ')\n}\nconst decodeXmlEntities = (s = '') => s.replace(RE_XML_ENTITY, FN_XML_ENTITY)\nconst escapeXml = (s) => !s ? '' : ('' + s).replace(RE_ESCAPE_XML_ENTITY, FN_ESCAPE_XML_ENTITY)\n\nlet UID = 1\n\nconst parseAttrs = (s) => {\n    const r = new Map()\n    if (!s) {\n    return r\n    }\n    while (1) {\n    let e = RE_ATTRS.exec(s)\n    if (!e) {\n        return r\n    }\n    r.set(e[1], decodeXmlEntities(e[2]))\n    }\n}\nconst stringifyAttrs = (attrs) => {\n    if (!attrs || !attrs.size) {\n    return ''\n    }\n    const r = []\n    attrs.forEach((v, k) => {\n    if (v && k !== '#text') {\n        r.push(' ' + k + '=\"' + escapeXml(v) + '\"')\n    }\n    })\n    return r.join('')\n}\n\nclass Node {\n    constructor (tag, attrs) {\n    this.uid = UID++\n    this.tag = tag || ''\n    this.attrs = attrs || new Map()\n    this.subs = []\n    }\n    getChild (index) {\n    return this.subs[index]\n    }\n    setText (text) {\n    this.attrs.set('#text', text)\n    }\n    addChild (tag, attrs) {\n    const e = new Node(tag, attrs)\n    this.subs.push(e)\n    return e\n    }\n    toString () {\n    return stringify(this, '')\n    }\n}\n\nfunction stringify ({ tag, attrs, subs }, tab) {\n    const sattrs = stringifyAttrs(attrs)\n    const ssubs = subs.map(c => stringify(c, `  ${tab}`)).join('\\n')\n    const text = attrs.get('#text')\n    const stext = text ? `  ${tab}${escapeXml(text)}` : ''\n    return `${tab}<${tag}${sattrs}` + (!ssubs && !stext ? '/>' : `>\\n${ssubs}${stext}\\n${tab}</${tag}>`)\n}\n\nexport const parseXML =  (_s, key) => {\n    const s = ('' + _s).trim().replace(RE_XML_COMMENT, '')\n    const ctx = [new Node()]\n    let lastIndex = 0\n    // head text omitted\n    while (1) {\n    let e = RE_XML_TAG.exec(s)\n    if (!e) {\n        break\n    }\n    // preceding text\n    const text = e.index && s.slice(lastIndex, e.index)\n    if (text && text.trim()) {\n        ctx[0].addChild('#text').setText(text)\n    }\n    // closing tag\n    if (e[2]) {\n        if (ctx[0].tag !== e[3]) {\n        throw new Error(\n            (key || '') + ' XML Parse closing tag does not match at: ' + e.index +\n            ' near ' + e.input.slice(Math.max(e.index - 15, 0), Math.min(e.index + 15, e.input.length)))\n        }\n        ctx.shift()\n    } else {\n        const elt = ctx[0].addChild(e[3], parseAttrs(e[4]))\n        // not single tag\n        if (!(e[5] || (e[3] in SINGLE_TAGS))) {\n        ctx.unshift(elt)\n        if (ctx.length === 1) {\n            throw new Error('Parse error at: ' + e[0])\n        }\n        }\n    }\n    // up past index\n    lastIndex = RE_XML_TAG.lastIndex\n    }\n    // tail text omitted\n    return ctx[0].getChild(0)\n}\n  "],"sourceRoot":""}