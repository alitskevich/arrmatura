{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./lib/compile.js","webpack:///./lib/component.js","webpack:///./lib/dom.js","webpack:///./lib/fragment.js","webpack:///./lib/index.js","webpack:///./lib/register.js","webpack:///./lib/render.js","webpack:///./lib/resolve.js","webpack:///./lib/xml.js"],"names":["VALUES","RE_SINGLE_PLACEHOLDER","RE_PLACEHOLDER","res","key","split","id","deep","target","app","resources","length","reduce","r","k","pipe","value","args","fn","call","$","owner","isFragment","apply","impl","map","a","prop","slice","ex","console","error","expression","v","placeholder","includes","match","trim","stringInterpolation","fnx","pattern","replace","s","expr","push","c","idx","pipes","initGettr","pipec","withPipes","initialValue","pk","assignKeyValue","acc","val","makeApplicator","get","hasSlot","content","forEach","e","tag","filterMapKey","src","Map","set","compileFor","attrs","uid","nodes","itemId","$for","inits","connect","rr","$data","updates","$nodes","emptyNode","find","compileNode","filter","loadingNode","itemNode","compileIf","aIf","iff","$if","neg","applicator","gttr","$then","ifElse","ifThen","then","compileTag","$tag","compile","has","ref","aProps","getter","Object","assign","v2","ekey","emitter","data","cb","emit","initials","node","COUNTER","nextId","p","methodName","x","pre","toUpperCase","bindFn","f","$boundFnMap","bound","bind","up","upAsync","promise","racer","raceCondition","akey","propGetter","$propFnMap","path","gettr","extractor1","$$","undefined","Component","Ctor","options","parent","props","ctx","elt","hidden","defer","cursor","prevElt","render","resolveTemplate","constructor","$TEMPLATE","isDone","isInited","init","d","done","children","nextElt","defered","Î”","changed","notify","entries","their","setter","propId","listeners","notifying","uuid","type","subscribe","event","warn","method","ReferenceError","result","log","COUNTERS","$weak","counter","camelize","sep","jn","i","join","DOM_SETTERS","textContent","disabled","cl","fl","eq","indexOf","className","selected","checked","$dataset","keys","dataset","click","setAttribute","ev","$attributes","blur","dblclick","scroll","getAttribute","keypress","keyCode","setTimeout","focus","enter","change","toggle","DOM_VALUE_COMPARATORS","_","mine","Element","document","createTextNode","createElement","applyAttributes","lstnrs","$listeners","removeEventListener","parentElement","removeChild","delta","before","nextSibling","firstChild","appendChild","insertBefore","theirs","mines","prototype","hasOwnProperty","def","fnValue","addEventListener","removeAttribute","WebClientApp","rootElement","body","launch","types","App","template","name","NAME","registerTypes","concat","window","requestAnimationFrame","Fragment","FragmentFor","Error","index","$ownerImpl","create","$owner","FragmentIf","FragmentTag","ANY","fnName","ctor","exec","toString","REGISTRY","reg","ctr","text","TEMPLATE","T","parseXML","getByTag","$content","size","cc","ch","resolveSlot","vv","resolveTemplateArray","tmpl","m","t","resolveProps","resolveRegular","RE_XML_ENTITY","RE_XML_COMMENT","RE_ATTRS","RE_ESCAPE_XML_ENTITY","RE_XML_TAG","SINGLE_TAGS","SUBST_XML_ENTITY","amp","gt","lt","quot","nbsp","ESCAPE_XML_ENTITY","RE_EMPTY","FN_ESCAPE_XML_ENTITY","charCodeAt","FN_XML_ENTITY","substring","String","fromCharCode","decodeXmlEntities","escapeXml","skipQoutes","UID","parseAttrs","stringifyAttrs","Node","stringify","tab","sattrs","ssubs","stext","_s","lastIndex","addChild","setText","input","Math","max","min","shift","unshift","getChild"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","\nconst VALUES = { true: true, false: false, null: null };\nconst RE_SINGLE_PLACEHOLDER = /^\\{([^}]+)\\}$/;\nconst RE_PLACEHOLDER = /\\{([^}]+)\\}/g;\n\nfunction res(key) {\n  const [id, ...deep] = key.split('.');\n  const target = id === 'app' ? this.app : this.app.resources[id];\n  if (deep.length === 0) {\n    return target;\n  }\n  if (deep.length === 1) {\n    return target[deep[0]];\n  }\n  return deep.reduce((r, k) => r ? r[k] : null, target)\n}\n\nfunction pipe(value, key) {\n  const [id, ...args] = key.split(':')\n  try {\n    const fn = res.call(this, id);\n    let $ = this.owner;\n    while ($.owner && $.isFragment) { $ = $.owner }\n\n    return fn.apply($.impl, [value, ...args.map(a => a[0] === '@' ? $.prop(a.slice(1)) : a)]);\n  } catch (ex) {\n    console.error('ERROR: Object.pipes.' + id, ex)\n    return value;\n  }\n}\n\n// Compilation\nexport function expression(v) {\n  if (v[0] === ':') { return placeholder(v); }\n  if (!v.includes('{')) { const r = v in VALUES ? VALUES[v] : v; return () => r; }\n  if (v.match(RE_SINGLE_PLACEHOLDER)) { return placeholder(v.slice(1, -1).trim()); }\n  return stringInterpolation(v);\n}\n\nexport function stringInterpolation(v, fnx = []) {\n  const pattern = v.replace(RE_PLACEHOLDER, (s, expr) => { fnx.push(placeholder(expr)); return '{{' + (fnx.length - 1) + '}}'; });\n  return c => !fnx.length ? pattern : pattern.replace(/\\{\\{(\\d+)\\}\\}/g, (s, idx) => {\n    const r = fnx[idx](c);\n    return !r && r !== 0 ? '' : r;\n  });\n}\n\nexport function placeholder(expr) {\n  const [key, ...pipes] = expr.split('|').map(s => s.trim());\n  const initGettr = (key[0] === ':')\n    ? (fn => c => res.call(c, fn(c)))(stringInterpolation(key.slice(1).trim()))\n    : c => c.prop(key)\n  const pipec = withPipes(pipes)\n  return c => pipec(c, initGettr(c))\n}\n\nexport function withPipes(pipes) {\n  return !pipes.length ? (c, v) => v : (c, initialValue) => pipes.reduce((r, pk) => pipe.call(c, r, pk), initialValue);\n}\n\nconst assignKeyValue = (acc, val, k) => {\n  if (k.slice(0, 5) === 'data-') {\n    acc['data'] = { ...acc['data'], [k.slice(5)]: val in VALUES ? VALUES[val] : val };\n  } else {\n    acc[k] = val;\n  }\n}\n\nconst makeApplicator = (get, k = '_') => (c, acc) => assignKeyValue(acc, get(c), k);\nconst hasSlot = (c, id) => {\n  let r = false;\n  if (id && id != 'default') {\n    c.content && c.content.forEach((e) => { r = r || (e.tag === c.tag + ':' + id) });\n  } else {\n    c.content && c.content.forEach((e) => { r = r || (e.tag.slice(0, c.tag.length + 1) !== c.tag + ':') });\n  }\n  return r\n}\n\nexport const filterMapKey = (src, key) => {\n  const r = new Map();\n  src.forEach((v, k) => { if (k !== key) { r.set(k, v); } });\n  return r;\n};\n\nexport function compileFor({ tag, attrs, uid, nodes }) {\n  const [itemId, , expr] = attrs.get('ui:for').split(' ');\n  const $for = { itemId };\n  const r = { tag: 'ui:for', isFragment: true, uid: 'for:' + expr + uid, $for, key: attrs.get('key') };\n  if ((expr.slice(0, 2) === '<-')) {\n    const [key, ...pipes] = expr.slice(2).split('|').map(s => s.trim());\n    const pipec = withPipes(pipes);\n    (r.inits || (r.inits = [])).push(c => c.connect(key, rr => ({ $data: pipec(c, rr) })));\n  } else {\n    (r.updates || (r.updates = [])).push(makeApplicator(expression('{:'.includes(expr[0]) ? expr : '{' + expr + '}'), '$data'));\n  }\n  let $nodes = nodes;\n  if (nodes && nodes.length) {\n    const emptyNode = $nodes.find(e => e.tag === 'ui:empty');\n    if (emptyNode) {\n      $for.emptyNode = emptyNode.nodes.map(compileNode);\n      $nodes = $nodes.filter(e => e !== emptyNode);\n    }\n    const loadingNode = $nodes.find(e => e.tag === 'ui:loading');\n    if (loadingNode) {\n      $for.loadingNode = loadingNode.nodes.map(compileNode);\n      $nodes = $nodes.filter(e => e !== loadingNode);\n    }\n  }\n  $for.itemNode = compileNode({ tag, attrs: filterMapKey(attrs, 'ui:for'), uid, nodes: $nodes });\n  return r;\n}\n\nexport function compileIf({ tag, attrs, uid, nodes }) {\n  const aIf = attrs.get('ui:if')\n  const iff = {};\n  const r = { tag: 'ui:if', isFragment: true, uid: 'if:' + aIf + uid, key: attrs.get('key'), $if: iff, };\n  const neg = aIf[0] === '!';\n  const expr = neg ? aIf.slice(1) : aIf;\n\n  if ((expr.slice(0, 2) === '<-')) {\n    const [key, ...pipes] = expr.slice(2).split('|').map(s => s.trim());\n    const pipec = withPipes(pipes);\n    const applicator = neg ? (c => rr => ({ $data: !pipec(c, rr) })) : (c => rr => ({ $data: (!!pipec(c, rr)) }));\n    (r.inits || (r.inits = [])).push(c => c.connect(key, applicator(c)));\n  } else if ((expr.slice(0, 5) === 'slot(')) {\n    const gttr = c => hasSlot(c, expr.slice(5, -1));\n    (r.updates || (r.updates = [])).push((c, acc) => { acc['$data'] = neg ? !gttr(c) : gttr(c); });\n  } else {\n    const gttr = expression(expr.includes('{') ? expr : '{' + expr + '}');\n    (r.updates || (r.updates = [])).push((c, acc) => { acc['$data'] = neg ? !gttr(c) : gttr(c); });\n  }\n  let $then = { tag, attrs: filterMapKey(attrs, 'ui:if'), uid, nodes };\n  if (nodes && nodes.length) {\n    const ifElse = nodes.find(e => e.tag === 'ui:else');\n    const ifThen = nodes.find(e => e.tag === 'ui:then');\n    if (ifElse) {\n      iff.else = ifElse.nodes.map(compileNode);\n      $then.nodes = ifThen ? ifThen.nodes : nodes.filter(e => e !== ifElse);\n    } else if (ifThen) {\n      $then.nodes = ifThen.nodes;\n    }\n  }\n  iff.then = [$then].map(compileNode);\n  return r;\n}\n\nexport function compileTag({ attrs, uid, nodes }) {\n  const expr = attrs.get('tag')\n  const r = {\n    tag: 'ui:tag',\n    isFragment: true,\n    uid: 'tag:' + expr + uid,\n    $tag: compile({ attrs: filterMapKey(attrs, 'tag'), nodes }),\n  };\n  if ((expr.slice(0, 2) === '<-')) {\n    (r.inits || (r.inits = [])).push(c => c.connect(expr.slice(2).trim(), (rr => ({ $data: rr }))));\n  } else {\n    const gttr = expression(expr);\n    (r.updates || (r.updates = [])).push((c, acc) => { acc['$data'] = gttr(c); });\n  }\n  return r;\n}\nexport function compile(r) {\n  const { attrs, nodes } = r;\n  if (attrs.has('id')) { r.id = attrs.get('id') }\n  if (attrs.has('ui:ref')) { r.ref = attrs.get('ui:ref') }\n  // ui:props\n  if (attrs.has('ui:props')) {\n    const aProps = attrs.get('ui:props');\n    if ((aProps.slice(0, 2) === '<-')) {\n      const [key, ...pipes] = aProps.slice(2).split('|').map(s => s.trim());\n      const pipec = withPipes(pipes);\n      (r.inits || (r.inits = [])).push(c => c.connect(key, rr => pipec(c, rr)));\n    } else {\n      const getter = expression(aProps);\n      (r.updates || (r.updates = [])).push((c, acc) => Object.assign(acc, getter(c)));\n    }\n  }\n  // attrs\n  attrs.forEach((v, k) => {\n    if (k.slice(0, 3) !== 'ui:') {\n      const v2 = v.slice(0, 2)\n      if (v2 === '<-') {\n        const [key, ...pipes] = v.slice(2).split('|').map(s => s.trim());\n        const pipec = withPipes(pipes);\n        (r.inits || (r.inits = [])).push(c => c.connect(key, rr => ({ [k]: pipec(c, rr) })));\n      } else if (v2 === '->') {\n        const [key, ...pipes] = v.slice(2).split('|').map(s => s.trim());\n        const expr = expression(key);\n        const pipec = withPipes(pipes);\n        const ekey = '$' + v + ':' + r.uid;\n        const emitter = c => c[ekey] || (c[ekey] = (data, cb) => c.emit(expr(c), pipec(c, data), cb));\n        (r.updates || (r.updates = [])).push((c, acc) => assignKeyValue(acc, emitter(c), k));\n      } else {\n        if (!v.includes('{') && v[0] !== ':' && k.slice(0, 5) !== 'data-') {\n          assignKeyValue((r.initials || (r.initials = {})), v, k);\n        } else {\n          (r.updates || (r.updates = [])).push(makeApplicator(expression(v), k));\n        }\n      }\n    }\n  });\n\n  r.nodes = nodes.map(compileNode)\n\n  return r;\n}\n\nexport function compileNode(node) {\n  if (node.attrs.has('ui:for')) { return compileFor(node); }\n  if (node.attrs.has('ui:if')) { return compileIf(node); }\n  if (node.tag === 'ui:tag') { return compileTag(node); }\n  if (node.tag === 'ui:fragment') { return Object.assign(compile(node), { isFragment: true }); }\n  return compile(node);\n}\n\n","/* eslint-disable no-console */\nimport { render } from './render.js';\nimport { resolveTemplate } from './resolve.js';\n\nlet COUNTER = 1;\n\nconst nextId = (p = '') => p + (COUNTER++);\n\nconst methodName = (x, pre = '') => {\n  if (!x) { return pre; }\n  const s = `${x}`;\n  return pre + s[0].toUpperCase() + s.slice(1);\n};\n\nfunction bindFn(f) {\n  const $ = this;\n  const map = $.$boundFnMap || ($.$boundFnMap = new Map());\n  let fn = map.get(f);\n  if (!fn) {\n    const bound = f.bind($.impl);\n    fn = (...args) => {\n      const r = bound(...args);\n      if (r) {\n        $.up(r)\n      }\n    }\n    map.set(f, fn);\n  }\n  return fn;\n}\n\nconst upAsync = ($, promise, key) => {\n  const racer = $.raceCondition('set:' + (key || 'up'));\n  const up = r => racer(() => $.up(r))\n  if (key && key !== '...') {\n    const akey = key.replace('Promise', '')\n    promise.then(val => up({ [akey + 'Error']: null, [akey]: val }), error => up({ [akey + 'Error']: error }));\n  } else {\n    promise.then(up, error => up({ error }));\n  }\n  return promise;\n}\nconst propGetter = ($, key) => {\n  const map = $.$propFnMap || ($.$propFnMap = {});\n  let fn = map[key];\n  if (fn) { return fn; }\n\n  const impl = $.impl\n  const [pk, ...path] = key.split('.')\n  const gettr = impl[methodName(pk, 'get')];\n\n  const extractor1 = gettr\n    ? () => gettr.call(impl)\n    : ($$ = impl.get ? impl.get(impl) : impl) =>\n      ((pk in $$) ? $$[pk] : $.owner && $.owner.prop && $.isFragment ? $.owner.prop(pk) : undefined);\n\n  fn = !path.length\n    ? extractor1\n    : () => path.reduce((r, p) => (r ? r[p] : r), extractor1())\n\n  return map[key] = fn;\n}\n\n\nexport class Component {\n\n  constructor(Ctor, options) {\n    Object.assign(this, options);\n    const { ref, parent, props } = this;\n    if (parent) {\n      this.app = parent.app;\n      this.ctx = this.elt = parent.elt;\n      this.impl = new Ctor(props, this);\n      this.impl.$ = this;\n      this.impl.app = this.app;\n      if (ref) {\n        const hidden = this.app[ref];\n        this.app[ref] = this.impl;\n        this.defer(() => { this.app[ref] = hidden })\n      }\n    } else {\n      this.app = this.impl = new Ctor(props, this);\n      this.impl.$ = this;\n    }\n  }\n\n  /**\n   * Rendering.\n   */\n\n  render() {\n    this.ctx.cursor = this.prevElt;\n    if (this.impl.render) {\n      this.impl.render(this, render);\n    } else {\n      render(this);\n    }\n  }\n\n  resolveTemplate() {\n    if (this.impl.resolveTemplate) {\n      return this.impl.resolveTemplate(this);\n    }\n    return resolveTemplate(this, this.impl.constructor.$TEMPLATE())\n  }\n\n  /**\n   * Life-cycle hooks.\n   */\n  init() {\n    if (this.isDone || this.isInited) { return; }\n    this.isInited = true;\n    // console.log('init', this.tag, this.uid)\n    if (this.inits) {\n      this.inits.forEach(f => this.defer(f(this)));\n      delete this.inits;\n    }\n    if (this.impl.init) {\n      const d = this.impl.init(this)\n      if (d) { this.up(d); }\n    }\n  }\n\n  done() {\n    if (this.isDone) { return; }\n    this.isDone = true;\n    if (this.impl.done) {\n      this.impl.done(this);\n    }\n    // console.log('done', this.tag, this.uid)\n    if (this.children) {\n      this.children.forEach(c => { c.parent = null; c.done(); })\n    }\n    if (this.parent) {\n      this.parent.children.delete(this.uid);\n    }\n    if (this.prevElt) {\n      this.prevElt.nextElt = this.nextElt;\n    }\n    if (this.defered) {\n      this.defered.forEach(f => f(this));\n      delete this.defered;\n    }\n    ['parent', 'children', 'owner', 'impl', 'app', 'ctx'].forEach(k => { delete this[k]; });\n  }\n\n  /**\n   * State.\n   */\n  up(Î”) {\n    if (this.isDone) { return; }\n    let changed = this.set(Î”);\n    this.render();\n    if (this.ref && changed) { this.notify(); }\n  }\n\n  set(Î”) {\n    const $ = this;\n    const impl = $.impl;\n    let changed = false;\n    if (impl.set) {\n      changed = impl.set(Î”);\n    } else if (Î”) {\n      if (Î”.then) {\n        upAsync($, Î”);\n      } else {\n        Object.entries(Î”).forEach(([k, their]) => {\n          if (their && their.then) {\n            upAsync($, their, k);\n          } else if (k && typeof their !== 'undefined' && their !== impl[k]) {\n            const setter = impl['set' + k[0].toUpperCase() + k.slice(1)];\n            if (setter) { setter.call(impl, their); } else { impl[k] = their; }\n            changed = true;\n          }\n        });\n      }\n    }\n    return changed;\n  }\n\n  prop(propId) {\n    const value = propGetter(this, propId)();\n    return (typeof value === 'function') ? bindFn.call(this, value) : value;\n  }\n\n  /**\n   *  Arrows.\n   */\n  notify() {\n    if (this.listeners && !this.notifying) {\n      this.notifying = true\n      this.listeners.forEach(e => e(this.impl))\n      this.notifying = false\n    }\n  }\n\n  subscribe(fn) {\n    const uuid = nextId();\n    const listeners = (this.listeners || (this.listeners = new Map()))\n    fn(this.impl);\n    listeners.set(uuid, fn);\n    return () => listeners.delete(uuid);\n  }\n\n  connect(key, applicator) {\n    const [type = this.ref, target] = key.split('.');\n    const ref = type === 'this' ? this.impl : this.app[type];\n    if (!ref) { console.error('connect: No such ref ' + type, key) }\n    return ref && ref.$.subscribe(() => {\n      try {\n        const value = ref.$.prop(target);\n        this.up(applicator ? (value && value.then ? value.then(applicator) : applicator(value)) : value)\n      } catch (ex) {\n        console.error('connect ' + type + ':' + target, ex)\n      }\n    });\n  }\n\n  emit(key, data) {\n\n    let $ = this;\n\n    if (!key || !key.includes('.')) {\n      // eslint-disable-next-line no-empty\n      while ($.owner && $.isFragment) { $ = $.owner }\n      return $.up(key ? { [key]: data } : data)\n    }\n\n    const [type, target] = key.split('.');\n    const event = { data, ...data };\n\n    const ref = type === 'this' ? $.impl : $.app[type];\n    if (!ref) {\n      console.warn('emit: No such ref ' + type);\n      return;\n    }\n    try {\n\n      const method = ref[methodName(target, 'on')];\n      if (!method) { throw new ReferenceError('emit ' + type + ': No such method ' + methodName(target, 'on')) }\n\n      const result = method.call(ref, event, ref, ref.$);\n      this.log(type + ':' + methodName(target, 'on'), result, event, ref)\n      if (result) { ref.$.up(result) }\n\n    } catch (ex) {\n      console.error('emit ' + key + ':', ex)\n    }\n  }\n\n  /**\n   * Routines.\n   */\n\n  raceCondition(key) {\n    const COUNTERS = this.$weak || (this.$weak = new Map())\n    let counter = 1 + (COUNTERS.get(key) || 0);\n    COUNTERS.set(key, counter)\n    return (fn) => {\n      if (counter === COUNTERS.get(key)) {\n        counter = 0;\n        fn()\n      }\n    }\n  }\n\n  defer(fn) { if (fn && typeof fn === 'function') { (this.defered || (this.defered = [])).push(fn); } }\n\n  log(...args) {\n    console.log(this.tag + this.uid, ...args)\n  }\n}\n","import { render } from './render.js';\nimport { Component } from './component.js';\nimport { registerTypes } from './register.js';\n\nconst camelize = (key, sep = '_', jn = ' ') => ('' + key).split(sep).map((s, i) => i ? s[0].toUpperCase() + s.slice(1) : s).join(jn);\n\n// DOM\nconst DOM_SETTERS = {\n  '#text': (e, v) => (e.textContent = v == null ? '' : v),\n  disabled: (e, v) => (e.disabled = v ? true : null),\n  class: (e, v) => {\n    if (v.includes(':')) {\n      v = ('' + v).split(' ').map(s => {\n        const [cl, expr] = s.split(':')\n        if (expr === undefined) return cl;\n        const [fl, eq] = expr.split('==');\n        const disabled = eq ? fl !== eq : ['', '0', 'false', null].indexOf(fl) > -1;\n        return disabled ? '' : cl;\n      }).join(' ')\n    }\n    e.className = v;\n  },\n  selected: (e, v) => (e.selected = v ? true : null),\n  value: (e, v) => (e.value = v == null ? '' : v),\n  checked: (e, v) => (e.checked = !!v),\n  init: function (e, v) {\n    this.init = () => v(e, this)\n  },\n  data: function (e, v) {\n    if (v && e.$dataset) {\n      Object.keys(e.$dataset).forEach(k => { if (!v[k]) { e.dataset[camelize(k, '-', '')] = null } });\n    }\n    e.$dataset = { ...v };\n    if (v) {\n      Object.keys(v).forEach(k => { e.dataset[camelize(k, '-', '')] = v[k]; });\n    }\n  },\n  click: function (e, v) {\n    this.setAttribute('click:click', !v ? null : (ev) => {\n      this.$attributes.click({ ...e.$dataset }, ev);\n      return false;\n    });\n  },\n  'bubble-click': function (e, v) {\n    this.setAttribute('bubbled-click:click', !v ? null : (ev) => {\n      this.$attributes['bubble-click']({ ...e.$dataset }, ev);\n      return true;\n    });\n  },\n  blur: function (e, v) {\n    this.setAttribute('blur:blur', !v ? null : (ev) => {\n      this.$attributes.blur({ ...e.$dataset }, ev);\n      return false;\n    });\n  },\n  dblclick: function (e, v) {\n    this.setAttribute('dblclick:dblclick', !v ? null : (ev) => {\n      this.$attributes.dblclick({ ...e.$dataset }, ev);\n      return false;\n    });\n  },\n  scroll: function (e, v) {\n    this.setAttribute('scroll:scroll', !v ? null : (ev) => {\n      this.$attributes.scroll({ ...e.$dataset }, ev);\n      return false;\n    });\n  },\n  error: function (e, v) {\n    this.setAttribute('error:error', !v ? null : (ev) => {\n      const fn = this.getAttribute('error');\n      fn && fn({ ...e.$dataset }, ev);\n      return false;\n    });\n  },\n  keypress: function (e, v) {\n    this.setAttribute('keypress:keyup', !v ? null : (ev) => {\n      if (ev.keyCode !== 13 && ev.keyCode !== 27) {\n        const fn = this.$attributes.keypress;\n        fn && fn({ value: e.value, ...e.$dataset }, ev);\n        setTimeout(() => e.focus(), 0)\n      }\n      return false;\n    });\n  },\n  enter: function (e, v) {\n    this.setAttribute('enter:keyup', !v ? null : (ev) => {\n      if (ev.keyCode === 13) {\n        this.$attributes.enter({ value: e.value, ...e.$dataset }, ev);\n      }\n      if (ev.keyCode === 13 || ev.keyCode === 27) {\n        e.blur();\n      }\n      return false;\n    });\n  },\n  change: function (e, v) {\n    this.setAttribute('change:change', !v ? null : (ev) => {\n      this.$attributes.change({ value: e.value, ...e.$dataset }, ev);\n      return false;\n    });\n  },\n  toggle: function (e, v) {\n    this.setAttribute('toggle:change', !v ? null : (ev) => {\n      this.$attributes.toggle({ value: e.checked, ...e.$dataset }, ev);\n      return false;\n    });\n  }\n};\n\nconst DOM_VALUE_COMPARATORS = {\n  value: (e, their) => (e.value === their),\n  _: (_, their, mine) => their === mine\n};\n\nclass Element {\n\n  constructor(attrs = {}, $) {\n    this.elt = $.elt = $.tag === '#text' ? document.createTextNode('') : document.createElement($.tag);\n    this.$attributes = {}\n    this.$ = this.elt.$ = $;\n    this.applyAttributes(attrs);\n  }\n  done() {\n    const e = this.elt;\n    const lstnrs = this.$listeners;\n    if (lstnrs) {\n      Object.keys(lstnrs).forEach(k => e.removeEventListener(k, lstnrs[k]));\n      this.$listeners = null;\n    }\n    const p = e.parentElement;\n    if (p) {\n      p.removeChild(e);\n    }\n    this.elt = this.$attributes = null;\n  }\n  set(delta) {\n    this.delta = this.delta ? Object.assign(this.delta, delta) : delta;\n    return this.$.nodes || delta && Object.keys(delta).length;\n  }\n  render($) {\n    const e = this.elt;\n    const p = $.ctx;\n    if ($.content) {\n      e.cursor = null;\n      render($, $.content);\n      e.cursor = null;\n    }\n    if (this.delta) {\n      this.applyAttributes(this.delta);\n      this.delta = null;\n    }\n    const before = p.cursor ? p.cursor.nextSibling : p.firstChild;\n    if (!before) {\n      if (p !== e.parentElement) {\n        p.appendChild(e);\n      }\n    } else if (e !== before) {\n      p.insertBefore(e, before);\n    }\n    p.cursor = e;\n  }\n  applyAttributes(theirs) {\n    const e = this.elt;\n    const mines = this.$attributes;\n    for (let key in theirs) {\n      if (Object.prototype.hasOwnProperty.call(theirs, key) && !(DOM_VALUE_COMPARATORS[key] || DOM_VALUE_COMPARATORS._)(e, theirs[key], mines[key])) {\n        const value = theirs[key];\n        const setter = DOM_SETTERS[key];\n        // console.log('setAttribute' + this.$.tag, key, value)\n        if (setter) {\n          setter.call(this, e, value);\n        } else {\n          this.setAttribute(key, value);\n        }\n      }\n    }\n    this.$attributes = theirs;\n  }\n  getAttribute(key, def) {\n    return (this.$attributes && this.$attributes[key]) || def\n  }\n  setAttribute(key, value) {\n    if (value != null) {\n      if (typeof value === 'function') {\n        const fnValue = (...args) => { if (!this.isDone) { value(...args) } }\n        if (!this.listeners) {\n          this.listeners = new Map();\n        }\n        if (!this.listeners.has(key)) {\n          const [akey, ekey = akey] = key.split(':')\n          this.elt.addEventListener(ekey, fnValue, false);\n          this.listeners.set(key, fnValue);\n        }\n      } else {\n        this.elt.setAttribute(key, value);\n      }\n    } else {\n      if (this.listeners && this.listeners.has(key)) {\n        const [akey, ekey = akey] = key.split(':')\n        this.elt.removeEventListener(ekey, this.listeners.get(key));\n        this.listeners.delete(key);\n      } else {\n        this.elt.removeAttribute(key);\n      }\n    }\n  }\n}\n\nclass WebClientApp {\n  constructor(props, $) {\n    Object.assign(this, props);\n    $.elt = $.ctx = props.rootElement || document.body;\n  }\n}\nWebClientApp.Element = Element;\n\nexport function launch({ types, App = WebClientApp, ...props } = {}) {\n  App.template = App.template || `<${types[0].name || types[0].NAME}/>`;\n  registerTypes([App, App.Element].concat(types))\n  const a = new Component(App, { props });\n\n  const fn = () => { render(a); a.init(); }\n  if (typeof window === 'object') {\n    window.requestAnimationFrame(fn);\n  } else {\n    fn()\n  }\n\n  return a.impl;\n}\n\nif (typeof window === 'object') {\n  window.launch = launch;\n}","import { resolveTemplate } from './resolve.js';\n\nexport class Fragment {\n    resolveTemplate($) {\n        return $.content;\n    }\n}\n\nexport class FragmentFor {\n    resolveTemplate($) {\n        const acc = new Map();\n        const { $data: data } = $.impl;\n        const { itemId, itemNode, emptyNode, loadingNode } = $.$for;\n        const { tag, updates, initials = {}, nodes, uid } = itemNode;\n        if (data && data.length) {\n            if (!data.forEach) {\n                throw new Error('wrong ui:for data', data)\n            }\n            data.forEach((d, index) => {\n                const id = `${uid}-$${d.id || index}`;\n                const $ownerImpl = Object.assign(Object.create($.owner.impl), { [itemId]: d, [itemId + 'Index']: index })\n                const up = Î” => $.owner.up(Î”)\n                const $owner = Object.assign(Object.create($.owner), { impl: $ownerImpl, $propFnMap: {}, up })\n                resolveTemplate($owner, { tag, initials, updates, nodes, uid: id }, acc);\n            });\n        } else if (!data) {\n            if (loadingNode) { resolveTemplate($.owner, loadingNode, acc); }\n        } else if (!data.length) {\n            if (emptyNode) { resolveTemplate($.owner, emptyNode, acc); }\n        }\n        return acc;\n    }\n}\n\nexport class FragmentIf {\n\n    resolveTemplate($) {\n        const $if = $.$if;\n        const { $data } = $.impl;\n        const node = $data ? $if.then : $if.else;\n        return resolveTemplate($, node);\n    }\n}\n\nexport class FragmentTag {\n    resolveTemplate($) {\n        const acc = new Map();\n        const tag = $.impl.$data;\n        if (tag) {\n            resolveTemplate($, { ...$.$tag, tag, uid: tag + ':' + $.uid }, acc);\n        }\n        return acc;\n    }\n}\n\n","export { launch } from './dom.js';\n","import { parseXML } from './xml.js';\nimport { compileNode } from './compile.js';\nimport { Fragment, FragmentFor, FragmentIf, FragmentTag } from './fragment.js';\n\nlet COUNTER = 1;\n\nlet ANY;\n\nconst nextId = (p = '') => p + (COUNTER++);\n\nconst fnName = ctor => (/^function\\s+([\\w$]+)\\s*\\(/.exec(ctor.toString()) || [])[1] || nextId('$C');\n\nconst REGISTRY = new Map([\n    ['ui:fragment', Fragment],\n    ['ui:for', FragmentFor],\n    ['ui:if', FragmentIf],\n    ['ui:tag', FragmentTag],\n]);\n\nconst reg = ctr => {\n    const ctor = typeof ctr === 'function' ? ctr : Object.assign(function () { }, ctr);\n    const name = ctor.NAME || ctor.name || fnName(ctor);\n    const text = ctor.TEMPLATE || ctor.template || ctor.prototype.TEMPLATE;\n    ctor.$TEMPLATE = () => {\n        try {\n            const T = text ? compileNode(parseXML(typeof text === 'function' ? text() : text, name)) : [];\n            ctor.$TEMPLATE = () => T;\n            return T;\n        } catch (ex) {\n            // eslint-disable-next-line no-console\n            console.error('compile ' + name, ex)\n        }\n        return []\n    }\n    if (name === 'Element') {\n        ANY = ctor\n    } else {\n        REGISTRY.set(name, ctor);\n    }\n};\n\nexport const registerTypes = types => types.forEach(reg);\n\nexport const getByTag = tag => REGISTRY.get(tag) || ANY;","import { getByTag } from './register.js';\nimport { Component } from './component.js';\n\nexport const render = (c, $content = c.resolveTemplate()) => {\n    if (!$content || !$content.size) {\n        if (c.children) { c.children.forEach(cc => cc.done()); }\n        return;\n    }\n    if (c.children) { c.children.forEach(cc => !$content.has(cc.uid) ? cc.done() : 0); }\n    const ch = c.children || (c.children = new Map());\n    $content.forEach(({ tag, content, owner, props, inits, initials, ref, $if, $for, $tag, isFragment }, uid) => {\n        let cc = ch.get(uid);\n        if (!cc) {\n            props = props && props.data && initials && initials.data\n                ? { ...props, ...initials, data: { ...initials.data, ...props.data } }\n                : { ...props, ...initials }\n            cc = new Component(\n                getByTag(tag),\n                { props, tag, ref, $if, $for, $tag, uid, owner, inits, parent: c, isFragment }\n            );\n            ch.set(uid, cc);\n        }\n        cc.owner = owner;\n        cc.content = content;\n        cc.prevElt = c.elt.cursor;\n        cc.up(props);\n    });\n    if (c.children) { c.children.forEach(cc => !cc.isInited ? cc.init() : 0); }\n};\n","const resolveSlot = (owner, id, acc) => {\n    let $ = owner\n    while ($.owner && $.isFragment) { $ = $.owner }\n\n    $.content && $.content.forEach((v) => {\n        if (id) {\n            if ((v.tag === $.tag + ':' + id) && v.content) {\n                v.content.forEach(vv => acc.set(vv.uid, vv));\n            }\n        } else if (v.tag.slice(0, $.tag.length + 1) !== $.tag + ':') {\n            acc.set(v.uid, v);\n        }\n    });\n    return acc;\n};\n\nconst resolveTemplateArray = (owner, tmpl, acc = new Map()) =>\n    tmpl && tmpl.length ? tmpl.reduce((m, t) => resolveTemplate(owner, t, m), acc) : null;\n\nconst resolveProps = (props, c) =>\n    props && props.length ? props.reduce((acc, fn) => { fn(c, acc); return acc; }, {}) : null;\n\nfunction resolveRegular(acc, owner, { tag, updates, initials, inits, nodes, uid, id, ref, $if, $for, $tag, isFragment }) {\n    if (tag === 'ui:slot') { return resolveSlot(owner, id, acc); }\n    const props = resolveProps(updates, owner);\n    const content = resolveTemplateArray(owner, nodes)\n    return acc.set(uid, { tag, id, uid, ref, owner, initials, inits, $if, $for, $tag, props, content, isFragment });\n}\n\nexport function resolveTemplate(owner, tmpl, acc = new Map()) {\n    if (!tmpl) { return acc; }\n    if (tmpl.reduce) { return tmpl.length ? resolveTemplateArray(owner, tmpl, acc) : acc; }\n    return resolveRegular(acc, owner, tmpl);\n}\n","// ==========\n// XML Parse for templates. XML -> NodeTree\n// ----------\nconst RE_XML_ENTITY = /&#?[0-9a-z]{3,5};/g;\nconst RE_XML_COMMENT = /<!--((?!-->)[\\s\\S])*-->/g;\nconst RE_ATTRS = /([a-z][a-zA-Z0-9-:]+)(=\"[^\"]*\"|={[^}]*})?/g;\nconst RE_ESCAPE_XML_ENTITY = /[\"'&<>]/g;\nconst RE_XML_TAG = /(<)(\\/?)([a-zA-Z][a-zA-Z0-9-:]*)((?:\\s+[a-z][a-zA-Z0-9-:]+(?:=\"[^\"]*\"|={[^}]*})?)*)\\s*(\\/?)>/g;\nconst SINGLE_TAGS = 'img input br col'.split(' ').reduce((r, e) => { r[e] = 1; return r; }, {});\nconst SUBST_XML_ENTITY = {\n    amp: '&',\n    gt: '>',\n    lt: '<',\n    quot: `\"`,\n    nbsp: ' '\n};\nconst ESCAPE_XML_ENTITY = {\n    34: '&quot;',\n    38: '&amp;',\n    39: '&#39;',\n    60: '&lt;',\n    62: '&gt;'\n};\nconst RE_EMPTY = /^\\s*$/\nconst FN_ESCAPE_XML_ENTITY = m => ESCAPE_XML_ENTITY[m.charCodeAt(0)];\nconst FN_XML_ENTITY = function (_) {\n    const s = _.substring(1, _.length - 1);\n    return s[0] === '#' ? String.fromCharCode(+s.slice(1)) : (SUBST_XML_ENTITY[s] || ' ');\n};\nconst decodeXmlEntities = (s = '') => s.replace(RE_XML_ENTITY, FN_XML_ENTITY);\nconst escapeXml = (s) => !s ? '' : ('' + s).replace(RE_ESCAPE_XML_ENTITY, FN_ESCAPE_XML_ENTITY);\nconst skipQoutes = (s) => s[0] === '\"' && s[s.length - 1] === '\"' ? s.slice(1, -1) : s;\n\nlet UID = 1;\n\nconst parseAttrs = (s) => {\n    const r = new Map();\n    if (!s) { return r; }\n    for (let e = RE_ATTRS.exec(s); e; e = RE_ATTRS.exec(s)) {\n        if (!e[2]) {\n            r.set(e[1], \"true\");\n        } else {\n            r.set(e[1], decodeXmlEntities(skipQoutes(e[2].slice(1))));\n        }\n    }\n    return r;\n};\nconst stringifyAttrs = (attrs) => {\n    if (!attrs || !attrs.size) {\n        return '';\n    }\n    const r = [];\n    attrs.forEach((v, k) => {\n        if (v && k !== '#text') {\n            r.push(' ' + k + '=\"' + escapeXml(v) + '\"');\n        }\n    });\n    return r.join('');\n};\n\nclass Node {\n    constructor(tag, attrs = new Map()) {\n        this.uid = UID++;\n        this.tag = tag || '';\n        this.attrs = attrs;\n        this.nodes = [];\n    }\n    getChild(index) {\n        return this.nodes[index];\n    }\n    setText(text) {\n        this.attrs.set('#text', decodeXmlEntities(text));\n    }\n    addChild(tag, attrs) {\n        const e = new Node(tag, attrs);\n        this.nodes.push(e);\n        return e;\n    }\n    toString() {\n        return stringify(this);\n    }\n}\n\nexport function stringify({ tag, attrs, nodes = [] }, tab = '') {\n    const sattrs = stringifyAttrs(attrs);\n    const ssubs = nodes.map(c => stringify(c, `  ${tab}`)).join('\\n');\n    const text = attrs && attrs.get('#text');\n    const stext = text ? `  ${tab}${escapeXml(text)}` : '';\n    if (tag === '#text') {\n        return stext.trim()\n    }\n    return `${tab}<${tag}${sattrs}` + (!ssubs && !stext ? '/>' : `>\\n${ssubs}${stext}\\n${tab}</${tag}>`);\n}\n\nexport const parseXML = (_s, key) => {\n    const s = ('' + _s).trim().replace(RE_XML_COMMENT, '');\n    const ctx = [new Node()];\n    let lastIndex = 0;\n    // head text omitted\n    for (let e = RE_XML_TAG.exec(s); e; e = RE_XML_TAG.exec(s)) {\n        // preceding text\n        const text = e.index && s.slice(lastIndex, e.index);\n        if (text && !text.match(RE_EMPTY)) {\n            ctx[0].addChild('#text').setText(text);\n        }\n        // closing tag\n        if (e[2]) {\n            if (ctx[0].tag !== e[3]) {\n                throw new Error(\n                    (key || '') + ' XML Parse closing tag does not match at: ' + e.index +\n                    ' near ' +\n                    e.input.slice(Math.max(e.index - 150, 0), e.index) +\n                    '^^^^' +\n                    e.input.slice(e.index, Math.min(e.index + 150, e.input.length))\n                );\n            }\n            ctx.shift();\n        } else {\n            const elt = ctx[0].addChild(e[3], parseAttrs(e[4]));\n            // not single tag\n            if (!(e[5] || (e[3] in SINGLE_TAGS))) {\n                ctx.unshift(elt);\n                if (ctx.length === 1) {\n                    throw new Error('Parse error at: ' + e[0]);\n                }\n            }\n        }\n        // up past index\n        lastIndex = RE_XML_TAG.lastIndex;\n    }\n    // tail text omitted\n    return ctx[0].getChild(0);\n};\n"],"sourceRoot":""}